{"version":3,"file":"useFilterable.js","sources":["../../../../../../src/components/va-data-table/hooks/useFilterable.ts"],"sourcesContent":["import { Ref, watch, computed, PropType, ExtractPropTypes } from 'vue'\n\nimport { useThrottleValue, useThrottleProps } from '../../../composables'\n\nimport type { DataTableRow, DataTableFilterMethod, DataTableItem } from '../types'\n\nexport const useFilterableProps = {\n  ...useThrottleProps,\n  filter: { type: String, default: '' },\n  filterMethod: { type: Function as PropType<DataTableFilterMethod | undefined> },\n}\n\nexport type TFilteredArgs = { items: DataTableItem[], itemsIndexes: number[] }\nexport type TFilterableEmits = (event: 'filtered', arg: TFilteredArgs) => void\n\nexport const useFilterable = (\n  rawRows: Ref<DataTableRow[]>,\n  props: ExtractPropTypes<typeof useFilterableProps>,\n  emit: TFilterableEmits,\n) => {\n  const filteredRows = computed<DataTableRow[]>(() => {\n    if (!rawRows.value.length) {\n      return rawRows.value\n    }\n\n    if (props.filter === '' && !props.filterMethod) {\n      return rawRows.value\n    }\n\n    return rawRows.value.filter(row => row.cells.some(cell => {\n      return typeof props.filterMethod === 'function'\n        ? props.filterMethod(cell.source)\n        : cell.value.toLowerCase().includes(props.filter.toLowerCase())\n    }))\n  })\n\n  const filteredRowsThrottled = useThrottleValue(filteredRows, props)\n\n  watch(filteredRowsThrottled, () => {\n    emit('filtered', {\n      items: filteredRowsThrottled.value.map(row => row.source),\n      itemsIndexes: filteredRowsThrottled.value.map(row => row.initialIndex),\n    })\n  })\n\n  return {\n    filteredRows: filteredRowsThrottled,\n  }\n}\n"],"names":[],"mappings":";;AAMO,MAAM,qBAAqB;AAAA,EAChC,GAAG;AAAA,EACH,QAAQ,EAAE,MAAM,QAAQ,SAAS,GAAG;AAAA,EACpC,cAAc,EAAE,MAAM,SAAwD;AAChF;AAKO,MAAM,gBAAgB,CAC3B,SACA,OACA,SACG;AACG,QAAA,eAAe,SAAyB,MAAM;AAC9C,QAAA,CAAC,QAAQ,MAAM,QAAQ;AACzB,aAAO,QAAQ;AAAA,IACjB;AAEA,QAAI,MAAM,WAAW,MAAM,CAAC,MAAM,cAAc;AAC9C,aAAO,QAAQ;AAAA,IACjB;AAEA,WAAO,QAAQ,MAAM,OAAO,SAAO,IAAI,MAAM,KAAK,CAAQ,SAAA;AACxD,aAAO,OAAO,MAAM,iBAAiB,aACjC,MAAM,aAAa,KAAK,MAAM,IAC9B,KAAK,MAAM,cAAc,SAAS,MAAM,OAAO,aAAa;AAAA,IACjE,CAAA,CAAC;AAAA,EAAA,CACH;AAEK,QAAA,wBAAwB,iBAAiB,cAAc,KAAK;AAElE,QAAM,uBAAuB,MAAM;AACjC,SAAK,YAAY;AAAA,MACf,OAAO,sBAAsB,MAAM,IAAI,CAAA,QAAO,IAAI,MAAM;AAAA,MACxD,cAAc,sBAAsB,MAAM,IAAI,CAAA,QAAO,IAAI,YAAY;AAAA,IAAA,CACtE;AAAA,EAAA,CACF;AAEM,SAAA;AAAA,IACL,cAAc;AAAA,EAAA;AAElB;"}