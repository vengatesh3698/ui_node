{"version":3,"file":"useCursorAnchor.js","sources":["../../../../../../src/components/va-dropdown/hooks/useCursorAnchor.ts"],"sourcesContent":["import { computed, reactive, Ref, watch, watchEffect } from 'vue'\nimport { useEvent } from '../../../composables/useEvent'\n\nexport const useCursorAnchor = (anchorRef: Ref<HTMLElement | undefined>, noUpdate: Ref<boolean>) => {\n  const mouse = reactive({ x: 0, y: 0 })\n\n  useEvent(['mousemove', 'mousedown', 'mouseup'], (e: MouseEvent) => {\n    const { x, y } = anchorRef.value!.getBoundingClientRect()\n    mouse.x = e.clientX - x\n    mouse.y = e.clientY - y\n  }, anchorRef)\n\n  const mouseOffset = {\n    x: 0,\n    y: 0,\n  }\n\n  watchEffect(() => {\n    if (noUpdate.value) { return }\n    mouseOffset.x = mouse.x\n    mouseOffset.y = mouse.y\n  })\n\n  return computed(() => {\n    if (!anchorRef.value) { return undefined }\n\n    const target = anchorRef.value\n\n    const getBoundingClientRect = () => {\n      const rect = target.getBoundingClientRect()\n      const x = rect.left + mouseOffset.x\n      const y = rect.top + mouseOffset.y\n\n      return {\n        ...rect,\n        x: x,\n        y: y,\n        bottom: y + 1,\n        right: x + 1,\n        left: x,\n        top: y,\n      }\n    }\n\n    return new Proxy<HTMLElement>(target, {\n      get (target, key: keyof typeof target) {\n        if (key === 'getBoundingClientRect') {\n          return getBoundingClientRect\n        }\n\n        return target[key]\n      },\n    })\n  })\n}\n"],"names":["target"],"mappings":";;AAGa,MAAA,kBAAkB,CAAC,WAAyC,aAA2B;AAClG,QAAM,QAAQ,SAAS,EAAE,GAAG,GAAG,GAAG,GAAG;AAErC,WAAS,CAAC,aAAa,aAAa,SAAS,GAAG,CAAC,MAAkB;AACjE,UAAM,EAAE,GAAG,EAAA,IAAM,UAAU,MAAO;AAC5B,UAAA,IAAI,EAAE,UAAU;AAChB,UAAA,IAAI,EAAE,UAAU;AAAA,KACrB,SAAS;AAEZ,QAAM,cAAc;AAAA,IAClB,GAAG;AAAA,IACH,GAAG;AAAA,EAAA;AAGL,cAAY,MAAM;AAChB,QAAI,SAAS,OAAO;AAAE;AAAA,IAAO;AAC7B,gBAAY,IAAI,MAAM;AACtB,gBAAY,IAAI,MAAM;AAAA,EAAA,CACvB;AAED,SAAO,SAAS,MAAM;AAChB,QAAA,CAAC,UAAU,OAAO;AAAS,aAAA;AAAA,IAAU;AAEzC,UAAM,SAAS,UAAU;AAEzB,UAAM,wBAAwB,MAAM;AAC5B,YAAA,OAAO,OAAO;AACd,YAAA,IAAI,KAAK,OAAO,YAAY;AAC5B,YAAA,IAAI,KAAK,MAAM,YAAY;AAE1B,aAAA;AAAA,QACL,GAAG;AAAA,QACH;AAAA,QACA;AAAA,QACA,QAAQ,IAAI;AAAA,QACZ,OAAO,IAAI;AAAA,QACX,MAAM;AAAA,QACN,KAAK;AAAA,MAAA;AAAA,IACP;AAGK,WAAA,IAAI,MAAmB,QAAQ;AAAA,MACpC,IAAKA,SAAQ,KAA0B;AACrC,YAAI,QAAQ,yBAAyB;AAC5B,iBAAA;AAAA,QACT;AAEA,eAAOA,QAAO,GAAG;AAAA,MACnB;AAAA,IAAA,CACD;AAAA,EAAA,CACF;AACH;"}