{"version":3,"file":"useDomRect.mjs","sources":["../../../../src/composables/useDomRect.ts"],"sourcesContent":["import { Ref, ref, watch } from 'vue'\nimport { unwrapEl } from '../utils/unwrapEl'\nimport { useRequestAnimationFrame } from './useRequestAnimationFrame'\n\nconst keys = ['x', 'y', 'width', 'height', 'top', 'left', 'right', 'bottom']\nconst isDomRectEqual = (a: any, b: any) => {\n  for (let i = 0; i < keys.length; i++) {\n    if (a[keys[i]] !== b[keys[i]]) {\n      return false\n    }\n  }\n  return true\n}\n\nexport const useDomRect = (target: Ref<HTMLElement | undefined>) => {\n  const domRect = ref<DOMRect | null>(null)\n\n  let prev = {}\n  useRequestAnimationFrame(() => {\n    const el = unwrapEl(target.value)\n    if (!el) { return }\n    const rect = el.getBoundingClientRect()\n    if (!isDomRectEqual(rect, prev)) {\n      domRect.value = rect\n    }\n    prev = rect\n  })\n\n  watch(target, (newVal) => {\n    const el = unwrapEl(newVal)\n    if (el) {\n      domRect.value = el.getBoundingClientRect()\n    } else {\n      domRect.value = null\n    }\n  })\n\n  return {\n    domRect,\n  }\n}\n"],"names":[],"mappings":";;;AAIA,MAAM,OAAO,CAAC,KAAK,KAAK,SAAS,UAAU,OAAO,QAAQ,SAAS,QAAQ;AAC3E,MAAM,iBAAiB,CAAC,GAAQ,MAAW;AACzC,WAAS,IAAI,GAAG,IAAI,KAAK,QAAQ,KAAK;AAChC,QAAA,EAAE,KAAK,CAAC,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC,GAAG;AACtB,aAAA;AAAA,IACT;AAAA,EACF;AACO,SAAA;AACT;AAEa,MAAA,aAAa,CAAC,WAAyC;AAC5D,QAAA,UAAU,IAAoB,IAAI;AAExC,MAAI,OAAO,CAAA;AACX,2BAAyB,MAAM;AACvB,UAAA,KAAK,SAAS,OAAO,KAAK;AAChC,QAAI,CAAC,IAAI;AAAE;AAAA,IAAO;AACZ,UAAA,OAAO,GAAG;AAChB,QAAI,CAAC,eAAe,MAAM,IAAI,GAAG;AAC/B,cAAQ,QAAQ;AAAA,IAClB;AACO,WAAA;AAAA,EAAA,CACR;AAEK,QAAA,QAAQ,CAAC,WAAW;AAClB,UAAA,KAAK,SAAS,MAAM;AAC1B,QAAI,IAAI;AACE,cAAA,QAAQ,GAAG;IAAsB,OACpC;AACL,cAAQ,QAAQ;AAAA,IAClB;AAAA,EAAA,CACD;AAEM,SAAA;AAAA,IACL;AAAA,EAAA;AAEJ;"}