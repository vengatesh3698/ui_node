{"version":3,"file":"useTextareaRowHeight.mjs","sources":["../../../../../../../src/components/va-input/components/VaTextarea/useTextareaRowHeight.ts"],"sourcesContent":["import { Ref } from 'vue'\n\nconst HIDDEN_TEXTAREA_STYLE = `\n  min-height:0 !important;\n  max-height:none !important;\n  height:0 !important;\n  visibility:hidden !important;\n  overflow:hidden !important;\n  position:absolute !important;\n  z-index:-1000 !important;\n  top:0 !important;\n  right:0 !important';\n`\n\nconst SIZING_STYLE = [\n  'letter-spacing',\n  'line-height',\n  'padding-top',\n  'padding-bottom',\n  'font-family',\n  'font-weight',\n  'font-size',\n  'text-rendering',\n  'text-transform',\n  'width',\n  'text-indent',\n  'padding-left',\n  'padding-right',\n  'border-width',\n  'box-sizing',\n]\n\nconst getNodeHeightStyles = (node: HTMLElement) => {\n  const style = window.getComputedStyle(node)\n\n  return {\n    boxSizing:\n      style.getPropertyValue('box-sizing') ||\n      style.getPropertyValue('-moz-box-sizing') ||\n      style.getPropertyValue('-webkit-box-sizing'),\n    padding:\n      parseFloat(style.getPropertyValue('padding-bottom')) +\n      parseFloat(style.getPropertyValue('padding-top')),\n    border:\n      parseFloat(style.getPropertyValue('border-bottom-width')) +\n      parseFloat(style.getPropertyValue('border-top-width')),\n    styles:\n      SIZING_STYLE.map(name => `${name}:${style.getPropertyValue(name)}`).join(';') + ';',\n    lineHeight:\n      parseInt(style.getPropertyValue('line-height')),\n  }\n}\n\nlet textarea: null | HTMLTextAreaElement = null\n\nconst createHiddenTextarea = (original: HTMLTextAreaElement, styles: string) => {\n  if (!textarea) {\n    textarea = document.createElement('textarea')\n  }\n\n  textarea.setAttribute('style', styles + HIDDEN_TEXTAREA_STYLE)\n  textarea.value = original.value || original.placeholder || ''\n  const wrap = original.getAttribute('wrap')\n\n  if (wrap !== null) {\n    textarea.setAttribute('wrap', wrap)\n  } else {\n    textarea.removeAttribute('wrap')\n  }\n\n  return textarea\n}\n\nexport const useTextareaRowHeight = (textarea: Ref<HTMLTextAreaElement | undefined>) => {\n  const calculateRowHeight = () => {\n    if (!textarea.value) { return 0 }\n\n    return getNodeHeightStyles(textarea.value).lineHeight\n  }\n\n  const calculateHeight = () => {\n    if (!textarea.value) { return 0 }\n\n    const { boxSizing, padding, border, styles } = getNodeHeightStyles(textarea.value)\n    const hiddenTextarea = createHiddenTextarea(textarea.value, styles)\n    document.body.appendChild(hiddenTextarea)\n    let height = hiddenTextarea.scrollHeight\n\n    if (boxSizing === 'border-box') {\n      height += border\n    } else if (boxSizing === 'content-box') {\n      height -= padding\n    }\n\n    document.body.removeChild(hiddenTextarea)\n\n    return height\n  }\n\n  return {\n    calculateRowHeight,\n    calculateHeight,\n  }\n}\n"],"names":["textarea"],"mappings":"AAEA,MAAM,wBAAwB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAY9B,MAAM,eAAe;AAAA,EACnB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF;AAEA,MAAM,sBAAsB,CAAC,SAAsB;AAC3C,QAAA,QAAQ,OAAO,iBAAiB,IAAI;AAEnC,SAAA;AAAA,IACL,WACE,MAAM,iBAAiB,YAAY,KACnC,MAAM,iBAAiB,iBAAiB,KACxC,MAAM,iBAAiB,oBAAoB;AAAA,IAC7C,SACE,WAAW,MAAM,iBAAiB,gBAAgB,CAAC,IACnD,WAAW,MAAM,iBAAiB,aAAa,CAAC;AAAA,IAClD,QACE,WAAW,MAAM,iBAAiB,qBAAqB,CAAC,IACxD,WAAW,MAAM,iBAAiB,kBAAkB,CAAC;AAAA,IACvD,QACE,aAAa,IAAI,CAAA,SAAQ,GAAG,QAAQ,MAAM,iBAAiB,IAAI,GAAG,EAAE,KAAK,GAAG,IAAI;AAAA,IAClF,YACE,SAAS,MAAM,iBAAiB,aAAa,CAAC;AAAA,EAAA;AAEpD;AAEA,IAAI,WAAuC;AAE3C,MAAM,uBAAuB,CAAC,UAA+B,WAAmB;AAC9E,MAAI,CAAC,UAAU;AACF,eAAA,SAAS,cAAc,UAAU;AAAA,EAC9C;AAES,WAAA,aAAa,SAAS,SAAS,qBAAqB;AAC7D,WAAS,QAAQ,SAAS,SAAS,SAAS,eAAe;AACrD,QAAA,OAAO,SAAS,aAAa,MAAM;AAEzC,MAAI,SAAS,MAAM;AACR,aAAA,aAAa,QAAQ,IAAI;AAAA,EAAA,OAC7B;AACL,aAAS,gBAAgB,MAAM;AAAA,EACjC;AAEO,SAAA;AACT;AAEa,MAAA,uBAAuB,CAACA,cAAmD;AACtF,QAAM,qBAAqB,MAAM;AAC3B,QAAA,CAACA,UAAS,OAAO;AAAS,aAAA;AAAA,IAAE;AAEzB,WAAA,oBAAoBA,UAAS,KAAK,EAAE;AAAA,EAAA;AAG7C,QAAM,kBAAkB,MAAM;AACxB,QAAA,CAACA,UAAS,OAAO;AAAS,aAAA;AAAA,IAAE;AAE1B,UAAA,EAAE,WAAW,SAAS,QAAQ,WAAW,oBAAoBA,UAAS,KAAK;AACjF,UAAM,iBAAiB,qBAAqBA,UAAS,OAAO,MAAM;AACzD,aAAA,KAAK,YAAY,cAAc;AACxC,QAAI,SAAS,eAAe;AAE5B,QAAI,cAAc,cAAc;AACpB,gBAAA;AAAA,IAAA,WACD,cAAc,eAAe;AAC5B,gBAAA;AAAA,IACZ;AAES,aAAA,KAAK,YAAY,cAAc;AAEjC,WAAA;AAAA,EAAA;AAGF,SAAA;AAAA,IACL;AAAA,IACA;AAAA,EAAA;AAEJ;"}