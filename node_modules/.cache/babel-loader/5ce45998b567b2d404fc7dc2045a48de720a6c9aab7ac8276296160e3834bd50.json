{"ast":null,"code":"import { _ as _sfc_main } from \"./VaVirtualScroller.vue_vue_type_script_lang-7ba8b424.mjs\";\nimport { openBlock, createElementBlock, normalizeClass, normalizeStyle, renderSlot, normalizeProps, guardReactiveProps, createElementVNode, Fragment, renderList, mergeProps } from \"vue\";\nimport { _ as _export_sfc } from \"../../../plugin-vue_export-helper-cc2b3d55.mjs\";\nconst VaVirtualScroller_vue_vue_type_style_index_0_lang = \"\";\nfunction _sfc_render(_ctx, _cache, $props, $setup, $data, $options) {\n  return openBlock(), createElementBlock(\"div\", {\n    ref: \"wrapper\",\n    class: normalizeClass([\"va-virtual-scroller\", _ctx.wrapperClassComputed]),\n    style: normalizeStyle(_ctx.wrapperStyleComputed)\n  }, [renderSlot(_ctx.$slots, \"content\", normalizeProps(guardReactiveProps({\n    containerStyleComputed: _ctx.containerStyleComputed,\n    listStyleComputed: _ctx.listStyleComputed,\n    renderBuffer: _ctx.renderBuffer,\n    uniqueKey: _ctx.uniqueKey,\n    currentListOffset: _ctx.currentListOffset\n  })), () => [createElementVNode(\"div\", {\n    class: \"va-virtual-scroller__container\",\n    style: normalizeStyle(_ctx.containerStyleComputed)\n  }, [createElementVNode(\"div\", {\n    ref: \"list\",\n    role: \"list\",\n    class: \"va-virtual-scroller__list\",\n    style: normalizeStyle(_ctx.listStyleComputed)\n  }, [(openBlock(true), createElementBlock(Fragment, null, renderList(_ctx.renderBuffer, (item, index) => {\n    return renderSlot(_ctx.$slots, \"default\", normalizeProps(mergeProps({\n      key: _ctx.uniqueKey(item, index)\n    }, {\n      item,\n      index: _ctx.renderStartIndex + index\n    })));\n  }), 128))], 4)], 4)])], 6);\n}\nconst _VaVirtualScroller = /* @__PURE__ */_export_sfc(_sfc_main, [[\"render\", _sfc_render]]);\nexport { _VaVirtualScroller as _ };","map":{"version":3,"names":["_sfc_render","_ctx","_cache","$props","$setup","$data","$options","openBlock","createElementBlock","ref","class","normalizeClass","wrapperClassComputed","style","normalizeStyle","wrapperStyleComputed","renderSlot","$slots","normalizeProps","guardReactiveProps","containerStyleComputed","listStyleComputed","renderBuffer","uniqueKey","currentListOffset","createElementVNode","role","Fragment","renderList","item","index","mergeProps","key","renderStartIndex"],"sources":["../../../../../src/components/va-virtual-scroller/VaVirtualScroller.vue"],"sourcesContent":["<template>\n  <div\n    ref=\"wrapper\"\n    class=\"va-virtual-scroller\"\n    :style=\"wrapperStyleComputed\"\n    :class=\"wrapperClassComputed\"\n  >\n    <slot\n      name=\"content\"\n      v-bind=\"{ containerStyleComputed, listStyleComputed, renderBuffer, uniqueKey, currentListOffset }\"\n    >\n      <div\n        class=\"va-virtual-scroller__container\"\n        :style=\"containerStyleComputed\"\n      >\n        <div\n          ref=\"list\"\n          role=\"list\"\n          class=\"va-virtual-scroller__list\"\n          :style=\"listStyleComputed\"\n        >\n          <template\n            v-for=\"(item, index) in renderBuffer\"\n            :key=\"uniqueKey(item, index)\"\n          >\n            <slot name=\"default\" v-bind=\"{ item, index: renderStartIndex + index }\" />\n          </template>\n        </div>\n      </div>\n    </slot>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, ref, computed, watch } from 'vue'\nimport pick from 'lodash/pick.js'\n\nimport { useEvent, useBem, useTrackBy, useTrackByProps } from '../../composables'\nimport { useVirtualScrollerSizes, useVirtualScrollerSizesProps } from './useVirtualScrollerSizes'\n\nexport default defineComponent({\n  name: 'VaVirtualScroller',\n\n  props: {\n    ...useTrackByProps,\n    ...useVirtualScrollerSizesProps,\n    items: { type: Array, default: () => ([]) },\n    bench: { type: Number, default: 10, validator: (v: number) => v >= 0 },\n    disabled: { type: Boolean, default: false },\n    table: { type: Boolean, default: false },\n  },\n\n  emits: ['scroll:bottom'],\n\n  setup: (props, { emit }) => {\n    const listScrollPosition = ref(0)\n    const scrollDirection = computed(() => props.horizontal ? 'scrollLeft' : 'scrollTop')\n    const handleScroll = () => {\n      if (!wrapper.value) { return }\n      listScrollPosition.value = wrapper.value[scrollDirection.value]\n    }\n    if (!props.disabled) { useEvent('scroll', handleScroll, true) }\n\n    const { list, wrapper, itemSize, wrapperSize } = useVirtualScrollerSizes(props, listScrollPosition)\n\n    const { getKey } = useTrackBy(props)\n    const uniqueKey = (item: Array<any> | Record<string, any>, index: number, defaultValue?: any) => getKey(item, index, defaultValue)\n\n    watch(listScrollPosition, (newValue) => {\n      if (newValue + wrapperSize.value === containerSize.value) {\n        emit('scroll:bottom')\n      }\n    })\n\n    // forming items to render\n    const renderStartIndex = computed(() => {\n      return Math.max(0, Math.floor(listScrollPosition.value / itemSize.value) - props.bench)\n    })\n    const renderItemsAmount = computed(() => {\n      if (!props.items?.length) { return 0 }\n      return props.disabled\n        ? props.items.length\n        : Math.min(props.items.length - renderStartIndex.value, Math.ceil(wrapperSize.value / itemSize.value) + props.bench * 2)\n    })\n    const renderEndIndex = computed(() => renderStartIndex.value + renderItemsAmount.value)\n    const renderBuffer = computed(() => {\n      if (!props.items?.length) { return [] }\n      return props.items.slice(renderStartIndex.value, renderEndIndex.value)\n    })\n\n    const sizeAttribute = computed(() => props.horizontal ? 'width' : 'height')\n\n    // wrapper styles and classes\n    const isDisabledVirtualTable = computed(() => props.table && props.disabled)\n\n    const wrapperStyleComputed = computed(() => ({\n      [sizeAttribute.value]: isDisabledVirtualTable.value || !wrapperSize.value ? undefined : `${wrapperSize.value}px`,\n    }))\n    const wrapperClassComputed = useBem('va-virtual-scroller', () => ({\n      ...pick(props, ['horizontal']),\n    }))\n\n    // container styles\n    const containerSize = computed(() => (props.items?.length ?? 0) * itemSize.value)\n    const containerStyleComputed = computed(() => ({\n      [sizeAttribute.value]: isDisabledVirtualTable.value ? undefined : `${containerSize.value}px`,\n    }))\n\n    // items list styles\n    const currentListOffset = computed(() => renderStartIndex.value * itemSize.value)\n    const listStyleComputed = computed(() => ({\n      transform: `translate${props.horizontal ? 'X' : 'Y'}(${currentListOffset.value}px)`,\n    }))\n\n    // public\n    const scrollToAttribute = computed(() => props.horizontal ? 'left' : 'top')\n    const virtualScrollTo = (index: number) => {\n      if (!index && index !== 0) { return }\n\n      wrapper.value?.scrollTo({ [scrollToAttribute.value]: index * itemSize.value })\n    }\n\n    return {\n      containerStyleComputed,\n      wrapperStyleComputed,\n      wrapperClassComputed,\n      listStyleComputed,\n      currentListOffset,\n      renderStartIndex,\n      virtualScrollTo,\n      renderBuffer,\n      uniqueKey,\n      wrapper,\n      list,\n    }\n  },\n})\n</script>\n\n<style lang=\"scss\">\n.va-virtual-scroller {\n  overflow: auto;\n  width: 100%;\n  height: 100%;\n\n  &__container {\n    position: relative;\n    overflow: hidden;\n    min-width: 100%;\n    min-height: 100%;\n  }\n\n  &__list {\n    display: flex;\n    flex-direction: column;\n  }\n\n  &--horizontal {\n    & .va-virtual-scroller__list {\n      flex-direction: row;\n    }\n  }\n}\n</style>\n"],"mappings":";;;;SAEQA,YAASC,IAAA,EAAAC,MAAA,EAAAC,MAAA,EAAAC,MAAA,EAAAC,KAAA,EAAAC,QAAA;EACR,OAAAC,SAAA,IAAAC,kBAAA,CAAC,OAEE;IADPC,GAAA,EAAK;IAAAC,KAAA,EAAAC,cAAA,yBAAAV,IAAA,CAAAW,oBAAA;IAGNC,KAAA,EAsBOC,cAAA,CAAAb,IAAA,CAAAc,oBAAA;EAAA,IAAAC,UAAA,CAjBGf,IAAA,CAAgCgB,MAAA,aAAAC,cAAA,CAAAC,kBAAA;IAAAC,sBAAA,EAAAnB,IAAA,CAAAmB,sBAAA;IAAAC,iBAAA,EAAApB,IAAA,CAAAoB,iBAAA;IAAAC,YAAA,EAAArB,IAAA,CAAAqB,YAAA;IAAAC,SAAA,EAAAtB,IAAA,CAAAsB,SAAA;IAAAC,iBAAA,EAAAvB,IAAA,CAAAuB;EAAA,YAAAC,kBAAA,CAChC,OAAE;IAAAf,KAAA;IAERG,KAAA,EAYMC,cAAA,CAAAb,IAAA,CAAAmB,sBAAA;EAAA,IAVOK,kBAAA;IACXhB,GAAA,EAAK;IACJiB,IAAA,EAAK;IAAAhB,KAAA;IAAAG,KAAA,EAAAC,cAAA,CAENb,IAAA,CAKWoB,iBAAA;EAAA,KAAAd,SAAA,CAHH,IAAqB,GAAAC,kBAAA,CAAAmB,QAAA,QAAAC,UAAA,CAAA3B,IAAA,CAAAqB,YAAA,GAAAO,IAAA,EAAAC,KAAA;IAEI,OAAAd,UAAA,CAAaf,IAAA,CAAAgB,MAAA,aAAmBC,cAAA,CAAKa,UAAA;MAAAC,GAAA,EAAA/B,IAAA,CAAAsB,SAAA,CAAAM,IAAA,EAAAC,KAAA;IAAA;MAAAD,IAAA;MAAAC,KAAA,EAAA7B,IAAA,CAAAgC,gBAAA,GAAAH;IAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}