{"ast":null,"code":"import { defineComponent, ref, computed, watch } from \"vue\";\nimport { p as pick } from \"../../../vendor-fff696df.mjs\";\nimport { u as useVirtualScrollerSizesProps, a as useVirtualScrollerSizes } from \"./useVirtualScrollerSizes-01d56be2.mjs\";\nimport { u as useTrackByProps, a as useTrackBy } from \"../../composables/useTrackBy-a799c188.mjs\";\nimport { u as useEvent } from \"../../composables/useEvent-d1ae925d.mjs\";\nimport { u as useBem } from \"../../composables/useBem-10a5bc6e.mjs\";\nconst _sfc_main = defineComponent({\n  name: \"VaVirtualScroller\",\n  props: {\n    ...useTrackByProps,\n    ...useVirtualScrollerSizesProps,\n    items: {\n      type: Array,\n      default: () => []\n    },\n    bench: {\n      type: Number,\n      default: 10,\n      validator: v => v >= 0\n    },\n    disabled: {\n      type: Boolean,\n      default: false\n    },\n    table: {\n      type: Boolean,\n      default: false\n    }\n  },\n  emits: [\"scroll:bottom\"],\n  setup: (props, {\n    emit\n  }) => {\n    const listScrollPosition = ref(0);\n    const scrollDirection = computed(() => props.horizontal ? \"scrollLeft\" : \"scrollTop\");\n    const handleScroll = () => {\n      if (!wrapper.value) {\n        return;\n      }\n      listScrollPosition.value = wrapper.value[scrollDirection.value];\n    };\n    if (!props.disabled) {\n      useEvent(\"scroll\", handleScroll, true);\n    }\n    const {\n      list,\n      wrapper,\n      itemSize,\n      wrapperSize\n    } = useVirtualScrollerSizes(props, listScrollPosition);\n    const {\n      getKey\n    } = useTrackBy(props);\n    const uniqueKey = (item, index, defaultValue) => getKey(item, index, defaultValue);\n    watch(listScrollPosition, newValue => {\n      if (newValue + wrapperSize.value === containerSize.value) {\n        emit(\"scroll:bottom\");\n      }\n    });\n    const renderStartIndex = computed(() => {\n      return Math.max(0, Math.floor(listScrollPosition.value / itemSize.value) - props.bench);\n    });\n    const renderItemsAmount = computed(() => {\n      var _a;\n      if (!((_a = props.items) == null ? void 0 : _a.length)) {\n        return 0;\n      }\n      return props.disabled ? props.items.length : Math.min(props.items.length - renderStartIndex.value, Math.ceil(wrapperSize.value / itemSize.value) + props.bench * 2);\n    });\n    const renderEndIndex = computed(() => renderStartIndex.value + renderItemsAmount.value);\n    const renderBuffer = computed(() => {\n      var _a;\n      if (!((_a = props.items) == null ? void 0 : _a.length)) {\n        return [];\n      }\n      return props.items.slice(renderStartIndex.value, renderEndIndex.value);\n    });\n    const sizeAttribute = computed(() => props.horizontal ? \"width\" : \"height\");\n    const isDisabledVirtualTable = computed(() => props.table && props.disabled);\n    const wrapperStyleComputed = computed(() => ({\n      [sizeAttribute.value]: isDisabledVirtualTable.value || !wrapperSize.value ? void 0 : `${wrapperSize.value}px`\n    }));\n    const wrapperClassComputed = useBem(\"va-virtual-scroller\", () => ({\n      ...pick(props, [\"horizontal\"])\n    }));\n    const containerSize = computed(() => {\n      var _a;\n      return (((_a = props.items) == null ? void 0 : _a.length) ?? 0) * itemSize.value;\n    });\n    const containerStyleComputed = computed(() => ({\n      [sizeAttribute.value]: isDisabledVirtualTable.value ? void 0 : `${containerSize.value}px`\n    }));\n    const currentListOffset = computed(() => renderStartIndex.value * itemSize.value);\n    const listStyleComputed = computed(() => ({\n      transform: `translate${props.horizontal ? \"X\" : \"Y\"}(${currentListOffset.value}px)`\n    }));\n    const scrollToAttribute = computed(() => props.horizontal ? \"left\" : \"top\");\n    const virtualScrollTo = index => {\n      var _a;\n      if (!index && index !== 0) {\n        return;\n      }\n      (_a = wrapper.value) == null ? void 0 : _a.scrollTo({\n        [scrollToAttribute.value]: index * itemSize.value\n      });\n    };\n    return {\n      containerStyleComputed,\n      wrapperStyleComputed,\n      wrapperClassComputed,\n      listStyleComputed,\n      currentListOffset,\n      renderStartIndex,\n      virtualScrollTo,\n      renderBuffer,\n      uniqueKey,\n      wrapper,\n      list\n    };\n  }\n});\nexport { _sfc_main as _ };\nimport '../../../VaVirtualScroller.css';","map":{"version":3,"names":["_sfc_main","defineComponent","name","props","useTrackByProps","useVirtualScrollerSizesProps","items","type","Array","default","bench","Number","validator","v","disabled","Boolean","table","emits","setup","emit","listScrollPosition","ref","scrollDirection","computed","horizontal","handleScroll","wrapper","value","useEvent","list","itemSize","wrapperSize","useVirtualScrollerSizes","getKey","useTrackBy","uniqueKey","item","index","defaultValue","watch","newValue","containerSize","renderStartIndex","Math","max","floor","renderItemsAmount","_a","length","min","ceil","renderEndIndex","renderBuffer","slice","sizeAttribute","isDisabledVirtualTable","wrapperStyleComputed","wrapperClassComputed","useBem","pick","containerStyleComputed","currentListOffset","listStyleComputed","transform","scrollToAttribute","virtualScrollTo","scrollTo"],"sources":["../../../../../src/components/va-virtual-scroller/VaVirtualScroller.vue"],"sourcesContent":["<template>\n  <div\n    ref=\"wrapper\"\n    class=\"va-virtual-scroller\"\n    :style=\"wrapperStyleComputed\"\n    :class=\"wrapperClassComputed\"\n  >\n    <slot\n      name=\"content\"\n      v-bind=\"{ containerStyleComputed, listStyleComputed, renderBuffer, uniqueKey, currentListOffset }\"\n    >\n      <div\n        class=\"va-virtual-scroller__container\"\n        :style=\"containerStyleComputed\"\n      >\n        <div\n          ref=\"list\"\n          role=\"list\"\n          class=\"va-virtual-scroller__list\"\n          :style=\"listStyleComputed\"\n        >\n          <template\n            v-for=\"(item, index) in renderBuffer\"\n            :key=\"uniqueKey(item, index)\"\n          >\n            <slot name=\"default\" v-bind=\"{ item, index: renderStartIndex + index }\" />\n          </template>\n        </div>\n      </div>\n    </slot>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, ref, computed, watch } from 'vue'\nimport pick from 'lodash/pick.js'\n\nimport { useEvent, useBem, useTrackBy, useTrackByProps } from '../../composables'\nimport { useVirtualScrollerSizes, useVirtualScrollerSizesProps } from './useVirtualScrollerSizes'\n\nexport default defineComponent({\n  name: 'VaVirtualScroller',\n\n  props: {\n    ...useTrackByProps,\n    ...useVirtualScrollerSizesProps,\n    items: { type: Array, default: () => ([]) },\n    bench: { type: Number, default: 10, validator: (v: number) => v >= 0 },\n    disabled: { type: Boolean, default: false },\n    table: { type: Boolean, default: false },\n  },\n\n  emits: ['scroll:bottom'],\n\n  setup: (props, { emit }) => {\n    const listScrollPosition = ref(0)\n    const scrollDirection = computed(() => props.horizontal ? 'scrollLeft' : 'scrollTop')\n    const handleScroll = () => {\n      if (!wrapper.value) { return }\n      listScrollPosition.value = wrapper.value[scrollDirection.value]\n    }\n    if (!props.disabled) { useEvent('scroll', handleScroll, true) }\n\n    const { list, wrapper, itemSize, wrapperSize } = useVirtualScrollerSizes(props, listScrollPosition)\n\n    const { getKey } = useTrackBy(props)\n    const uniqueKey = (item: Array<any> | Record<string, any>, index: number, defaultValue?: any) => getKey(item, index, defaultValue)\n\n    watch(listScrollPosition, (newValue) => {\n      if (newValue + wrapperSize.value === containerSize.value) {\n        emit('scroll:bottom')\n      }\n    })\n\n    // forming items to render\n    const renderStartIndex = computed(() => {\n      return Math.max(0, Math.floor(listScrollPosition.value / itemSize.value) - props.bench)\n    })\n    const renderItemsAmount = computed(() => {\n      if (!props.items?.length) { return 0 }\n      return props.disabled\n        ? props.items.length\n        : Math.min(props.items.length - renderStartIndex.value, Math.ceil(wrapperSize.value / itemSize.value) + props.bench * 2)\n    })\n    const renderEndIndex = computed(() => renderStartIndex.value + renderItemsAmount.value)\n    const renderBuffer = computed(() => {\n      if (!props.items?.length) { return [] }\n      return props.items.slice(renderStartIndex.value, renderEndIndex.value)\n    })\n\n    const sizeAttribute = computed(() => props.horizontal ? 'width' : 'height')\n\n    // wrapper styles and classes\n    const isDisabledVirtualTable = computed(() => props.table && props.disabled)\n\n    const wrapperStyleComputed = computed(() => ({\n      [sizeAttribute.value]: isDisabledVirtualTable.value || !wrapperSize.value ? undefined : `${wrapperSize.value}px`,\n    }))\n    const wrapperClassComputed = useBem('va-virtual-scroller', () => ({\n      ...pick(props, ['horizontal']),\n    }))\n\n    // container styles\n    const containerSize = computed(() => (props.items?.length ?? 0) * itemSize.value)\n    const containerStyleComputed = computed(() => ({\n      [sizeAttribute.value]: isDisabledVirtualTable.value ? undefined : `${containerSize.value}px`,\n    }))\n\n    // items list styles\n    const currentListOffset = computed(() => renderStartIndex.value * itemSize.value)\n    const listStyleComputed = computed(() => ({\n      transform: `translate${props.horizontal ? 'X' : 'Y'}(${currentListOffset.value}px)`,\n    }))\n\n    // public\n    const scrollToAttribute = computed(() => props.horizontal ? 'left' : 'top')\n    const virtualScrollTo = (index: number) => {\n      if (!index && index !== 0) { return }\n\n      wrapper.value?.scrollTo({ [scrollToAttribute.value]: index * itemSize.value })\n    }\n\n    return {\n      containerStyleComputed,\n      wrapperStyleComputed,\n      wrapperClassComputed,\n      listStyleComputed,\n      currentListOffset,\n      renderStartIndex,\n      virtualScrollTo,\n      renderBuffer,\n      uniqueKey,\n      wrapper,\n      list,\n    }\n  },\n})\n</script>\n\n<style lang=\"scss\">\n.va-virtual-scroller {\n  overflow: auto;\n  width: 100%;\n  height: 100%;\n\n  &__container {\n    position: relative;\n    overflow: hidden;\n    min-width: 100%;\n    min-height: 100%;\n  }\n\n  &__list {\n    display: flex;\n    flex-direction: column;\n  }\n\n  &--horizontal {\n    & .va-virtual-scroller__list {\n      flex-direction: row;\n    }\n  }\n}\n</style>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}