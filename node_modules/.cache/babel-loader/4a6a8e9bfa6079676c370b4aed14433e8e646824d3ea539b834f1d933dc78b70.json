{"ast":null,"code":"import { defineComponent, ref, computed, onMounted, watch, toRef } from \"vue\";\nimport { V as VaFileUploadKey } from \"../types-8c5c5611.mjs\";\nimport { u as useTextColor } from \"../../../composables/useTextColor-f36510ca.mjs\";\nimport { V as VaFileUploadUndo } from \"../VaFileUploadUndo/index-4fe4ca4a.mjs\";\nimport { V as VaButton } from \"../../va-button/index-b0a9ef70.mjs\";\nimport { V as VaListItem, a as VaListItemSection } from \"../../va-list/index-c1a821d7.mjs\";\nimport { d as colorToRgba } from \"../../../services/color/utils-21d3493b.mjs\";\nimport { u as useStrictInject } from \"../../../composables/useStrictInject-08ce5ce6.mjs\";\nimport { u as useFocus } from \"../../../composables/useFocus-4393f76a.mjs\";\nimport { u as useBem } from \"../../../composables/useBem-10a5bc6e.mjs\";\nimport { u as useTranslation } from \"../../../composables/useTranslation-acf7d88d.mjs\";\nconst INJECTION_ERROR_MESSAGE = \"The VaFileUploadGalleryItem component should be used in the context of VaFileUpload component\";\nconst _sfc_main = defineComponent({\n  name: \"VaFileUploadGalleryItem\",\n  components: {\n    VaFileUploadUndo,\n    VaButton,\n    VaListItem,\n    VaListItemSection\n  },\n  emits: [\"remove\"],\n  props: {\n    file: {\n      type: Object,\n      default: null\n    },\n    color: {\n      type: String,\n      default: \"success\"\n    },\n    ariaRemoveFileLabel: {\n      type: String,\n      default: \"$t:removeFile\"\n    }\n  },\n  setup(props, {\n    emit\n  }) {\n    const {\n      undo,\n      disabled,\n      undoDuration\n    } = useStrictInject(VaFileUploadKey, INJECTION_ERROR_MESSAGE);\n    const {\n      isFocused,\n      onFocus,\n      onBlur\n    } = useFocus();\n    const previewImage = ref(\"\");\n    const removed = ref(false);\n    const overlayStylesComputed = computed(() => ({\n      backgroundColor: colorToRgba(props.color, 0.7)\n    }));\n    const classesComputed = useBem(\"va-file-upload-gallery-item\", () => ({\n      notImage: !previewImage.value,\n      focused: isFocused.value,\n      undo: removed.value\n    }));\n    const removeImage = () => {\n      if (undo.value) {\n        removed.value = true;\n        setTimeout(() => {\n          if (!removed.value) {\n            return;\n          }\n          emit(\"remove\");\n          removed.value = false;\n        }, undoDuration.value ?? 0);\n      } else {\n        emit(\"remove\");\n        removed.value = false;\n      }\n    };\n    const recoverImage = () => {\n      removed.value = false;\n    };\n    const convertToImg = () => {\n      if (!props.file.name || !props.file.image) {\n        return;\n      }\n      if (props.file.image.url) {\n        previewImage.value = props.file.image.url;\n      } else if (props.file.image instanceof File) {\n        const reader = new FileReader();\n        reader.readAsDataURL(props.file.image);\n        reader.onload = e => {\n          var _a, _b;\n          if (((_a = e.target) == null ? void 0 : _a.result).includes(\"image\")) {\n            previewImage.value = (_b = e.target) == null ? void 0 : _b.result;\n          }\n        };\n      }\n    };\n    onMounted(convertToImg);\n    watch(() => props.file, convertToImg);\n    return {\n      ...useTranslation(),\n      undo,\n      ...useTextColor(toRef(props, \"color\")),\n      removed,\n      disabled,\n      isFocused,\n      previewImage,\n      classesComputed,\n      overlayStylesComputed,\n      onBlur,\n      onFocus,\n      removeImage,\n      recoverImage\n    };\n  }\n});\nexport { _sfc_main as _ };\nimport '../../../../VaFileUploadGalleryItem.css';","map":{"version":3,"names":["INJECTION_ERROR_MESSAGE","_sfc_main","defineComponent","name","components","VaFileUploadUndo","VaButton","VaListItem","VaListItemSection","emits","props","file","type","Object","default","color","String","ariaRemoveFileLabel","setup","emit","undo","disabled","undoDuration","useStrictInject","VaFileUploadKey","isFocused","onFocus","onBlur","useFocus","previewImage","ref","removed","overlayStylesComputed","computed","backgroundColor","colorToRgba","classesComputed","useBem","notImage","value","focused","removeImage","setTimeout","recoverImage","convertToImg","image","url","File","reader","FileReader","readAsDataURL","onload","e","_a","target","result","includes","_b","onMounted","watch","useTranslation","useTextColor","toRef"],"sources":["../../../../../../src/components/va-file-upload/VaFileUploadGalleryItem/VaFileUploadGalleryItem.vue"],"sourcesContent":["<template>\n  <va-list-item\n    class=\"va-file-upload-gallery-item\"\n    tabindex=\"-1\"\n    :class=\"classesComputed\"\n    :disabled=\"disabled\"\n    :aria-disabled=\"disabled\"\n    @focus=\"onFocus\"\n    @blur=\"onBlur\"\n  >\n    <va-list-item-section v-if=\"removed && undo\">\n      <va-file-upload-undo vertical @recover=\"recoverImage\" />\n    </va-list-item-section>\n    <va-list-item-section v-else>\n      <img\n        v-if=\"previewImage\"\n        :src=\"previewImage\"\n        :alt=\"file.name || ''\"\n        class=\"va-file-upload-gallery-item__image\"\n      >\n      <div class=\"va-file-upload-gallery-item__overlay\">\n        <div\n          class=\"va-file-upload-gallery-item__overlay-background\"\n          :style=\"overlayStylesComputed\"\n        />\n        <div\n          v-if=\"file && file.name\"\n          class=\"va-file-upload-gallery-item__name\"\n          :title=\"file.name\"\n          :style=\"{ color: textColorComputed }\"\n        >\n          {{ file.name }}\n        </div>\n        <va-button\n          v-if=\"!disabled\"\n          flat\n          color=\"danger\"\n          icon=\"va-delete\"\n          class=\"va-file-upload-gallery-item__delete\"\n          :aria-label=\"tp($props.ariaRemoveFileLabel)\"\n          @click=\"removeImage\"\n          @focus=\"onFocus\"\n          @blur=\"onBlur\"\n        />\n      </div>\n    </va-list-item-section>\n  </va-list-item>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, onMounted, PropType, ref, watch, computed, toRef } from 'vue'\n\nimport { colorToRgba } from '../../../services/color'\nimport { useFocus, useBem, useStrictInject, useTranslation } from '../../../composables'\n\nimport { VaFileUploadKey, ConvertedFile } from '../types'\nimport { useTextColor } from '../../../composables/useTextColor'\n\nimport { VaButton, VaListItem, VaListItemSection } from '../../index'\nimport { VaFileUploadUndo } from '../VaFileUploadUndo'\n\nconst INJECTION_ERROR_MESSAGE = 'The VaFileUploadGalleryItem component should be used in the context of VaFileUpload component'\n\nexport default defineComponent({\n  name: 'VaFileUploadGalleryItem',\n\n  components: {\n    VaFileUploadUndo,\n    VaButton,\n    VaListItem,\n    VaListItemSection,\n  },\n\n  emits: ['remove'],\n\n  props: {\n    file: { type: Object as PropType<ConvertedFile>, default: null },\n    color: { type: String, default: 'success' },\n\n    ariaRemoveFileLabel: { type: String, default: '$t:removeFile' },\n  },\n\n  setup (props, { emit }) {\n    const {\n      undo,\n      disabled,\n      undoDuration,\n    } = useStrictInject(VaFileUploadKey, INJECTION_ERROR_MESSAGE)\n    const { isFocused, onFocus, onBlur } = useFocus()\n    const previewImage = ref('')\n    const removed = ref(false)\n\n    const overlayStylesComputed = computed(() => ({\n      backgroundColor: colorToRgba(props.color, 0.7),\n    }))\n\n    const classesComputed = useBem('va-file-upload-gallery-item', () => ({\n      notImage: !previewImage.value,\n      focused: isFocused.value,\n      undo: removed.value,\n    }))\n\n    const removeImage = () => {\n      if (undo.value) {\n        removed.value = true\n\n        setTimeout(() => {\n          if (!removed.value) { return }\n\n          emit('remove')\n          removed.value = false\n        }, undoDuration.value ?? 0)\n      } else {\n        emit('remove')\n        removed.value = false\n      }\n    }\n\n    const recoverImage = () => { removed.value = false }\n\n    const convertToImg = () => {\n      if (!props.file.name || !props.file.image) { return }\n\n      if (props.file.image.url) {\n        previewImage.value = props.file.image.url\n      } else if (props.file.image instanceof File) {\n        const reader = new FileReader()\n\n        reader.readAsDataURL(props.file.image)\n        reader.onload = (e) => {\n          if ((e.target?.result as string).includes('image')) {\n            previewImage.value = e.target?.result as string\n          }\n        }\n      }\n    }\n\n    onMounted(convertToImg)\n    watch(() => props.file, convertToImg)\n\n    return {\n      ...useTranslation(),\n      undo,\n      ...useTextColor(toRef(props, 'color')),\n      removed,\n      disabled,\n      isFocused,\n      previewImage,\n      classesComputed,\n      overlayStylesComputed,\n\n      onBlur,\n      onFocus,\n      removeImage,\n      recoverImage,\n    }\n  },\n})\n</script>\n\n<style lang='scss'>\n@import \"variables\";\n@import \"../../../styles/resources\";\n\n$max-image-size: 8.5714rem;\n\n.va-file-upload-gallery-item {\n  display: flex;\n  position: relative;\n  margin-bottom: 1rem;\n  margin-right: 0.5rem;\n  flex-basis: calc(14.2857% - 0.5rem);\n  max-width: calc(14.2857% - 0.5rem);\n  min-width: $max-image-size;\n  border-radius: 0.375rem;\n  overflow: hidden;\n  width: 100%;\n  align-items: stretch;\n\n  @include media-breakpoint-down(md) {\n    flex-basis: calc(16.667% - 0.5rem);\n    max-width: calc(16.667% - 0.5rem);\n  }\n\n  @include media-breakpoint-down(sm) {\n    flex-basis: calc(20% - 0.5rem);\n    max-width: calc(20% - 0.5rem);\n  }\n\n  @include media-breakpoint-down(xs) {\n    flex-basis: calc(50% - 0.5rem);\n    max-width: calc(50% - 0.5rem);\n  }\n\n  &:last-of-type {\n    margin-right: 0;\n  }\n\n  &:hover,\n  &:focus,\n  &--focused {\n    .va-file-upload-gallery-item__overlay {\n      z-index: 3;\n      opacity: 1;\n    }\n\n    .va-file-upload-gallery-item {\n      &__name {\n        color: var(--va-file-upload-gallery-item-text-hover);\n      }\n    }\n  }\n\n  &__overlay {\n    display: flex;\n    position: absolute;\n    height: 100%;\n    width: 100%;\n    top: 0;\n    left: 0;\n    flex-direction: column;\n    padding: 0.5rem;\n    z-index: -1;\n    opacity: 0;\n  }\n\n  &__overlay-background {\n    position: absolute;\n    height: 100%;\n    width: 100%;\n    top: 0;\n    left: 0;\n    z-index: -1;\n  }\n\n  &__image {\n    width: 100%;\n    box-shadow: var(--va-box-shadow);\n    object-fit: cover;\n    z-index: 1;\n  }\n\n  &__name {\n    color: var(--va-file-upload-gallery-item-text);\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    font-size: 0.875rem;\n  }\n\n  &__delete {\n    cursor: pointer;\n    font-size: 1.5rem;\n    margin-top: auto;\n  }\n\n  &--not-image {\n    .va-file-upload-gallery-item__overlay {\n      display: flex;\n    }\n  }\n\n  &--undo {\n    .va-list-item__inner {\n      display: flex;\n      align-items: flex-start;\n      position: relative;\n    }\n\n    .va-list-item-section {\n      height: inherit;\n      padding: 0;\n    }\n\n    .va-file-upload-undo {\n      flex: 1;\n    }\n  }\n}\n</style>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}