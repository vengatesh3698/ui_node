{"ast":null,"code":"import { _ as _sfc_main } from \"./VaFileUploadGalleryItem.vue_vue_type_script_lang-5f252f78.mjs\";\nimport { resolveComponent, openBlock, createBlock, normalizeClass, withCtx, createVNode, createElementBlock, createCommentVNode, createElementVNode, normalizeStyle, toDisplayString } from \"vue\";\nimport { _ as _export_sfc } from \"../../../../plugin-vue_export-helper-cc2b3d55.mjs\";\nconst VaFileUploadGalleryItem_vue_vue_type_style_index_0_lang = \"\";\nconst _hoisted_1 = [\"src\", \"alt\"];\nconst _hoisted_2 = {\n  class: \"va-file-upload-gallery-item__overlay\"\n};\nconst _hoisted_3 = [\"title\"];\nfunction _sfc_render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_va_file_upload_undo = resolveComponent(\"va-file-upload-undo\");\n  const _component_va_list_item_section = resolveComponent(\"va-list-item-section\");\n  const _component_va_button = resolveComponent(\"va-button\");\n  const _component_va_list_item = resolveComponent(\"va-list-item\");\n  return openBlock(), createBlock(_component_va_list_item, {\n    class: normalizeClass([\"va-file-upload-gallery-item\", _ctx.classesComputed]),\n    tabindex: \"-1\",\n    disabled: _ctx.disabled,\n    \"aria-disabled\": _ctx.disabled,\n    onFocus: _ctx.onFocus,\n    onBlur: _ctx.onBlur\n  }, {\n    default: withCtx(() => [_ctx.removed && _ctx.undo ? (openBlock(), createBlock(_component_va_list_item_section, {\n      key: 0\n    }, {\n      default: withCtx(() => [createVNode(_component_va_file_upload_undo, {\n        vertical: \"\",\n        onRecover: _ctx.recoverImage\n      }, null, 8, [\"onRecover\"])]),\n      _: 1\n    })) : (openBlock(), createBlock(_component_va_list_item_section, {\n      key: 1\n    }, {\n      default: withCtx(() => [_ctx.previewImage ? (openBlock(), createElementBlock(\"img\", {\n        key: 0,\n        src: _ctx.previewImage,\n        alt: _ctx.file.name || \"\",\n        class: \"va-file-upload-gallery-item__image\"\n      }, null, 8, _hoisted_1)) : createCommentVNode(\"\", true), createElementVNode(\"div\", _hoisted_2, [createElementVNode(\"div\", {\n        class: \"va-file-upload-gallery-item__overlay-background\",\n        style: normalizeStyle(_ctx.overlayStylesComputed)\n      }, null, 4), _ctx.file && _ctx.file.name ? (openBlock(), createElementBlock(\"div\", {\n        key: 0,\n        class: \"va-file-upload-gallery-item__name\",\n        title: _ctx.file.name,\n        style: normalizeStyle({\n          color: _ctx.textColorComputed\n        })\n      }, toDisplayString(_ctx.file.name), 13, _hoisted_3)) : createCommentVNode(\"\", true), !_ctx.disabled ? (openBlock(), createBlock(_component_va_button, {\n        key: 1,\n        flat: \"\",\n        color: \"danger\",\n        icon: \"va-delete\",\n        class: \"va-file-upload-gallery-item__delete\",\n        \"aria-label\": _ctx.tp(_ctx.$props.ariaRemoveFileLabel),\n        onClick: _ctx.removeImage,\n        onFocus: _ctx.onFocus,\n        onBlur: _ctx.onBlur\n      }, null, 8, [\"aria-label\", \"onClick\", \"onFocus\", \"onBlur\"])) : createCommentVNode(\"\", true)])]),\n      _: 1\n    }))]),\n    _: 1\n  }, 8, [\"class\", \"disabled\", \"aria-disabled\", \"onFocus\", \"onBlur\"]);\n}\nconst _VaFileUploadGalleryItem = /* @__PURE__ */_export_sfc(_sfc_main, [[\"render\", _sfc_render]]);\nexport { _VaFileUploadGalleryItem as _ };","map":{"version":3,"names":["resolveComponent","openBlock","createBlock","_component_va_list_item","class","normalizeClass","_ctx","classesComputed","tabindex","disabled","onFocus","onBlur","default","withCtx","removed","undo","_component_va_list_item_section","key","createVNode","_component_va_file_upload_undo","vertical","onRecover","recoverImage","previewImage","createElementBlock","src","alt","file","name","_hoisted_1","createCommentVNode","createElementVNode","_hoisted_2","style","normalizeStyle","overlayStylesComputed","title","color","textColorComputed","toDisplayString","_hoisted_3","_component_va_button","flat","icon","tp","$props","ariaRemoveFileLabel","onClick","removeImage"],"sources":["../../../../../../src/components/va-file-upload/VaFileUploadGalleryItem/VaFileUploadGalleryItem.vue"],"sourcesContent":["<template>\n  <va-list-item\n    class=\"va-file-upload-gallery-item\"\n    tabindex=\"-1\"\n    :class=\"classesComputed\"\n    :disabled=\"disabled\"\n    :aria-disabled=\"disabled\"\n    @focus=\"onFocus\"\n    @blur=\"onBlur\"\n  >\n    <va-list-item-section v-if=\"removed && undo\">\n      <va-file-upload-undo vertical @recover=\"recoverImage\" />\n    </va-list-item-section>\n    <va-list-item-section v-else>\n      <img\n        v-if=\"previewImage\"\n        :src=\"previewImage\"\n        :alt=\"file.name || ''\"\n        class=\"va-file-upload-gallery-item__image\"\n      >\n      <div class=\"va-file-upload-gallery-item__overlay\">\n        <div\n          class=\"va-file-upload-gallery-item__overlay-background\"\n          :style=\"overlayStylesComputed\"\n        />\n        <div\n          v-if=\"file && file.name\"\n          class=\"va-file-upload-gallery-item__name\"\n          :title=\"file.name\"\n          :style=\"{ color: textColorComputed }\"\n        >\n          {{ file.name }}\n        </div>\n        <va-button\n          v-if=\"!disabled\"\n          flat\n          color=\"danger\"\n          icon=\"va-delete\"\n          class=\"va-file-upload-gallery-item__delete\"\n          :aria-label=\"tp($props.ariaRemoveFileLabel)\"\n          @click=\"removeImage\"\n          @focus=\"onFocus\"\n          @blur=\"onBlur\"\n        />\n      </div>\n    </va-list-item-section>\n  </va-list-item>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, onMounted, PropType, ref, watch, computed, toRef } from 'vue'\n\nimport { colorToRgba } from '../../../services/color'\nimport { useFocus, useBem, useStrictInject, useTranslation } from '../../../composables'\n\nimport { VaFileUploadKey, ConvertedFile } from '../types'\nimport { useTextColor } from '../../../composables/useTextColor'\n\nimport { VaButton, VaListItem, VaListItemSection } from '../../index'\nimport { VaFileUploadUndo } from '../VaFileUploadUndo'\n\nconst INJECTION_ERROR_MESSAGE = 'The VaFileUploadGalleryItem component should be used in the context of VaFileUpload component'\n\nexport default defineComponent({\n  name: 'VaFileUploadGalleryItem',\n\n  components: {\n    VaFileUploadUndo,\n    VaButton,\n    VaListItem,\n    VaListItemSection,\n  },\n\n  emits: ['remove'],\n\n  props: {\n    file: { type: Object as PropType<ConvertedFile>, default: null },\n    color: { type: String, default: 'success' },\n\n    ariaRemoveFileLabel: { type: String, default: '$t:removeFile' },\n  },\n\n  setup (props, { emit }) {\n    const {\n      undo,\n      disabled,\n      undoDuration,\n    } = useStrictInject(VaFileUploadKey, INJECTION_ERROR_MESSAGE)\n    const { isFocused, onFocus, onBlur } = useFocus()\n    const previewImage = ref('')\n    const removed = ref(false)\n\n    const overlayStylesComputed = computed(() => ({\n      backgroundColor: colorToRgba(props.color, 0.7),\n    }))\n\n    const classesComputed = useBem('va-file-upload-gallery-item', () => ({\n      notImage: !previewImage.value,\n      focused: isFocused.value,\n      undo: removed.value,\n    }))\n\n    const removeImage = () => {\n      if (undo.value) {\n        removed.value = true\n\n        setTimeout(() => {\n          if (!removed.value) { return }\n\n          emit('remove')\n          removed.value = false\n        }, undoDuration.value ?? 0)\n      } else {\n        emit('remove')\n        removed.value = false\n      }\n    }\n\n    const recoverImage = () => { removed.value = false }\n\n    const convertToImg = () => {\n      if (!props.file.name || !props.file.image) { return }\n\n      if (props.file.image.url) {\n        previewImage.value = props.file.image.url\n      } else if (props.file.image instanceof File) {\n        const reader = new FileReader()\n\n        reader.readAsDataURL(props.file.image)\n        reader.onload = (e) => {\n          if ((e.target?.result as string).includes('image')) {\n            previewImage.value = e.target?.result as string\n          }\n        }\n      }\n    }\n\n    onMounted(convertToImg)\n    watch(() => props.file, convertToImg)\n\n    return {\n      ...useTranslation(),\n      undo,\n      ...useTextColor(toRef(props, 'color')),\n      removed,\n      disabled,\n      isFocused,\n      previewImage,\n      classesComputed,\n      overlayStylesComputed,\n\n      onBlur,\n      onFocus,\n      removeImage,\n      recoverImage,\n    }\n  },\n})\n</script>\n\n<style lang='scss'>\n@import \"variables\";\n@import \"../../../styles/resources\";\n\n$max-image-size: 8.5714rem;\n\n.va-file-upload-gallery-item {\n  display: flex;\n  position: relative;\n  margin-bottom: 1rem;\n  margin-right: 0.5rem;\n  flex-basis: calc(14.2857% - 0.5rem);\n  max-width: calc(14.2857% - 0.5rem);\n  min-width: $max-image-size;\n  border-radius: 0.375rem;\n  overflow: hidden;\n  width: 100%;\n  align-items: stretch;\n\n  @include media-breakpoint-down(md) {\n    flex-basis: calc(16.667% - 0.5rem);\n    max-width: calc(16.667% - 0.5rem);\n  }\n\n  @include media-breakpoint-down(sm) {\n    flex-basis: calc(20% - 0.5rem);\n    max-width: calc(20% - 0.5rem);\n  }\n\n  @include media-breakpoint-down(xs) {\n    flex-basis: calc(50% - 0.5rem);\n    max-width: calc(50% - 0.5rem);\n  }\n\n  &:last-of-type {\n    margin-right: 0;\n  }\n\n  &:hover,\n  &:focus,\n  &--focused {\n    .va-file-upload-gallery-item__overlay {\n      z-index: 3;\n      opacity: 1;\n    }\n\n    .va-file-upload-gallery-item {\n      &__name {\n        color: var(--va-file-upload-gallery-item-text-hover);\n      }\n    }\n  }\n\n  &__overlay {\n    display: flex;\n    position: absolute;\n    height: 100%;\n    width: 100%;\n    top: 0;\n    left: 0;\n    flex-direction: column;\n    padding: 0.5rem;\n    z-index: -1;\n    opacity: 0;\n  }\n\n  &__overlay-background {\n    position: absolute;\n    height: 100%;\n    width: 100%;\n    top: 0;\n    left: 0;\n    z-index: -1;\n  }\n\n  &__image {\n    width: 100%;\n    box-shadow: var(--va-box-shadow);\n    object-fit: cover;\n    z-index: 1;\n  }\n\n  &__name {\n    color: var(--va-file-upload-gallery-item-text);\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    font-size: 0.875rem;\n  }\n\n  &__delete {\n    cursor: pointer;\n    font-size: 1.5rem;\n    margin-top: auto;\n  }\n\n  &--not-image {\n    .va-file-upload-gallery-item__overlay {\n      display: flex;\n    }\n  }\n\n  &--undo {\n    .va-list-item__inner {\n      display: flex;\n      align-items: flex-start;\n      position: relative;\n    }\n\n    .va-list-item-section {\n      height: inherit;\n      padding: 0;\n    }\n\n    .va-file-upload-undo {\n      flex: 1;\n    }\n  }\n}\n</style>\n"],"mappings":";;;;;;;;;;;;;kCACEA,gBAAA,CA6Ce;SA3CbC,SAAA,CAAa,GAAAC,WAAA,CAAAC,uBAAA;IAEZC,KAAA,EAAkBC,cAAA,iCAAAC,IAAA,CAAAC,eAAA;IAClBC,QAAA;IACAC,QAAA,EAAOH,IAAA,CAAAG,QAAA;IACP,iBAAMH,IAAA,CAAMG,QAAA;IAAAC,OAAA,EAAAJ,IAAA,CAAAI,OAAA;IAAAC,MAAA,EAAAL,IAAA,CAAAK;;IAEbC,OAAA,EAAAC,OAAA,QAAAP,IAAA,CAAAQ,OAAA,IAAAR,IAAA,CAAAS,IAAA,IAAAd,SAAA,IAC0DC,WAAA,CAAAc,+BAAA;MAAAC,GAAA;IAAA;MAAAL,OAAA,EAAnCC,OAAA,CAAQ,OAAAK,WAAA,CAAWC,8BAAA,EAAY;QAAAC,QAAA;QAAAC,SAAA,EAAAf,IAAA,CAAAgB;;;wBAIhCpB,WAAA,CAAAc,+BAAA;MAAAC,GAAA;IAAA;MADpBL,OAAA,EAAAC,OAAA,QAAAP,IAAA,CAAAiB,YAAA,IAAAtB,SAAA,IAEoBuB,kBAAA;QACjBP,GAAA,EAAK;QACNQ,GAAA,EAAKnB,IAAA,CAACiB,YAAA;QAAAG,GAAA,EAAApB,IAAA,CAAAqB,IAAA,CAAAC,IAAA;QAAAxB,KAAA;MAER,YAAAyB,UAwBM,KAvBJC,kBAAA,CAGE,WAFMC,kBAAA,QAAAC,UAAA,GAAAD,kBAAA,CACA,OAAE;QAAA3B,KAAA;QAGF6B,KAAA,EAAAC,cAAA,CAAa5B,IAAA,CAAI6B,qBAAA;MAAA,aACjB7B,IAAA,CAAAqB,IAAA,IAAArB,IAAA,CAAAqB,IAAA,CAAAC,IAAA,IAAA3B,SAAA,IAAAuB,kBAAA;QACLP,GAAA,EAAK;QACLb,KAAA,EAAK;QAAAgC,KAAA,EAAA9B,IAAA,CAAAqB,IAAA,CAAAC,IAAA;QAAAK,KAAA,EAAAC,cAAA;UAAAG,KAAA,EAAA/B,IAAA,CAAAgC;QAAA;MAKC,GAAAC,eAAA,CAAQjC,IAAA,CAAAqB,IAAA,CAAAC,IAAA,OAAAY,UAAA,KAAAV,kBAAA,CADjB,IAUE,OARI,CAAAxB,IAAA,CAAAG,QAAA,IAAAR,SAAA,IAAAC,WAAA,CAAAuC,oBAAA;QACJxB,GAAA,EAAK;QACLyB,IAAA,EAAK;QACLL,KAAA,EAAM;QACLM,IAAA;QACAvC,KAAA,EAAK;QACL,cAAOE,IAAA,CAAOsC,EAAA,CAAAtC,IAAA,CAAAuC,MAAA,CAAAC,mBAAA;QACdC,OAAA,EAAMzC,IAAA,CAAA0C,WAAA;QAAAtC,OAAA,EAAAJ,IAAA,CAAAI,OAAA;QAAAC,MAAA,EAAAL,IAAA,CAAAK"},"metadata":{},"sourceType":"module","externalDependencies":[]}