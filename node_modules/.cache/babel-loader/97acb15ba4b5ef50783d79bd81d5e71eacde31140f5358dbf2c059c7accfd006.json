{"ast":null,"code":"import { u as useComponentPresetProp } from \"../../composables/useComponentPreset-0dfbd395.mjs\";\nimport { u as useScrollParent } from \"../../composables/useScrollParent-8c92e184.mjs\";\nimport { defineComponent, shallowRef, ref, computed, onMounted, onBeforeUnmount } from \"vue\";\nimport { w as warn } from \"../../utils/console-42c8e8cc.mjs\";\nconst _sfc_main = defineComponent({\n  name: \"VaParallax\",\n  props: {\n    ...useComponentPresetProp,\n    target: {\n      type: [Object, String]\n    },\n    src: {\n      type: String,\n      default: \"\",\n      required: true\n    },\n    alt: {\n      type: String,\n      default: \"parallax\"\n    },\n    height: {\n      type: Number,\n      default: 400\n    },\n    reversed: {\n      type: Boolean,\n      default: false\n    },\n    speed: {\n      type: Number,\n      default: 0.5,\n      validator: value => value >= 0 && value <= 1\n    }\n  },\n  setup(props) {\n    const rootElement = shallowRef();\n    const img = shallowRef();\n    const elOffsetTop = ref(0);\n    const parallax = ref(0);\n    const parallaxDist = ref(0);\n    const percentScrolled = ref(0);\n    const scrollTop = ref(0);\n    const windowHeight = ref(0);\n    const windowBottom = ref(0);\n    const isLoaded = ref(false);\n    const computedWrapperStyles = computed(() => ({\n      height: props.height + \"px\"\n    }));\n    const computedImgStyles = computed(() => ({\n      display: \"block\",\n      transform: `translate(-50%, ${parallax.value}px)`,\n      opacity: isLoaded.value ? 1 : 0,\n      top: props.reversed ? 0 : \"auto\"\n    }));\n    const {\n      getScrollableParent\n    } = useScrollParent();\n    const targetElement = computed(() => {\n      var _a;\n      if (!props.target) {\n        return getScrollableParent((_a = rootElement.value) == null ? void 0 : _a.parentElement);\n      }\n      if (props.target instanceof HTMLElement) {\n        return props.target;\n      }\n      const element = document.querySelector(props.target);\n      if (element) {\n        return element;\n      }\n      warn(\"VaParallax target prop got wrong selector. Target is null\");\n      return null;\n    });\n    const imgHeight = computed(() => {\n      var _a;\n      return ((_a = img.value) == null ? void 0 : _a.naturalHeight) || 0;\n    });\n    const calcDimensions = () => {\n      var _a, _b;\n      const offset = ((_a = rootElement.value) == null ? void 0 : _a.getBoundingClientRect()) || {\n        top: 0\n      };\n      scrollTop.value = ((_b = targetElement.value) == null ? void 0 : _b.scrollTop) || 0;\n      parallaxDist.value = imgHeight.value - props.height;\n      elOffsetTop.value = offset.top + scrollTop.value;\n      windowHeight.value = window.innerHeight;\n      windowBottom.value = scrollTop.value + windowHeight.value;\n    };\n    const translate = () => {\n      calcDimensions();\n      percentScrolled.value = (windowBottom.value - elOffsetTop.value) / (props.height + windowHeight.value);\n      parallax.value = Math.round(parallaxDist.value * percentScrolled.value) * props.speed;\n      if (props.reversed) {\n        parallax.value = -parallax.value;\n      }\n    };\n    const addEventListeners = () => {\n      var _a, _b;\n      (_a = targetElement.value) == null ? void 0 : _a.addEventListener(\"scroll\", translate);\n      (_b = targetElement.value) == null ? void 0 : _b.addEventListener(\"resize\", translate);\n    };\n    const removeEventListeners = () => {\n      var _a, _b;\n      (_a = targetElement.value) == null ? void 0 : _a.removeEventListener(\"scroll\", translate);\n      (_b = targetElement.value) == null ? void 0 : _b.removeEventListener(\"resize\", translate);\n    };\n    const initImage = () => {\n      var _a, _b;\n      if ((_a = img.value) == null ? void 0 : _a.complete) {\n        translate();\n        addEventListeners();\n      } else {\n        (_b = img.value) == null ? void 0 : _b.addEventListener(\"load\", () => {\n          translate();\n          addEventListeners();\n        }, false);\n      }\n      isLoaded.value = true;\n    };\n    onMounted(initImage);\n    onBeforeUnmount(removeEventListeners);\n    return {\n      img,\n      rootElement,\n      computedWrapperStyles,\n      computedImgStyles\n    };\n  }\n});\nexport { _sfc_main as _ };\nimport '../../../VaParallax.css';","map":{"version":3,"names":["_sfc_main","defineComponent","name","props","useComponentPresetProp","target","type","Object","String","src","default","required","alt","height","Number","reversed","Boolean","speed","validator","value","setup","rootElement","shallowRef","img","elOffsetTop","ref","parallax","parallaxDist","percentScrolled","scrollTop","windowHeight","windowBottom","isLoaded","computedWrapperStyles","computed","computedImgStyles","display","transform","opacity","top","getScrollableParent","useScrollParent","targetElement","_a","parentElement","HTMLElement","element","document","querySelector","warn","imgHeight","naturalHeight","calcDimensions","offset","getBoundingClientRect","_b","window","innerHeight","translate","Math","round","addEventListeners","addEventListener","removeEventListeners","removeEventListener","initImage","complete","onMounted","onBeforeUnmount"],"sources":["../../../../../src/components/va-parallax/VaParallax.vue"],"sourcesContent":["<template>\n  <div\n    ref=\"rootElement\"\n    class=\"va-parallax\"\n    :style=\"computedWrapperStyles\"\n  >\n    <div class=\"va-parallax__image-container\">\n      <img\n        ref=\"img\"\n        class=\"va-parallax__image\"\n        :src=\"$props.src\"\n        :alt=\"$props.alt\"\n        :style=\"computedImgStyles\"\n      />\n    </div>\n    <div class=\"va-parallax__item-container\">\n      <slot />\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { useComponentPresetProp } from '../../composables/useComponentPreset'\nimport { useScrollParent } from '../../composables/useScrollParent'\nimport { defineComponent, PropType, ref, computed, onMounted, onBeforeUnmount, shallowRef } from 'vue'\nimport { warn } from '../../utils/console'\n\nexport default defineComponent({\n  name: 'VaParallax',\n  props: {\n    ...useComponentPresetProp,\n    target: { type: [Object, String] as PropType<HTMLElement | string | undefined> },\n    src: { type: String, default: '', required: true },\n    alt: { type: String, default: 'parallax' },\n    height: { type: Number, default: 400 },\n    reversed: { type: Boolean, default: false },\n    speed: {\n      type: Number,\n      default: 0.5,\n      validator: (value: number) => value >= 0 && value <= 1,\n    },\n  },\n  setup (props) {\n    const rootElement = shallowRef<HTMLElement>()\n    const img = shallowRef<HTMLImageElement>()\n\n    const elOffsetTop = ref(0)\n    const parallax = ref(0)\n    const parallaxDist = ref(0)\n    const percentScrolled = ref(0)\n    const scrollTop = ref(0)\n    const windowHeight = ref(0)\n    const windowBottom = ref(0)\n    const isLoaded = ref(false)\n\n    const computedWrapperStyles = computed(() => ({ height: props.height + 'px' }))\n\n    const computedImgStyles = computed(() => ({\n      display: 'block',\n      transform: `translate(-50%, ${parallax.value}px)`,\n      opacity: isLoaded.value ? 1 : 0,\n      top: props.reversed ? 0 : 'auto',\n    }))\n\n    const { getScrollableParent } = useScrollParent()\n\n    const targetElement = computed(() => {\n      if (!props.target) {\n        return getScrollableParent(rootElement.value?.parentElement)\n      }\n\n      if (props.target instanceof HTMLElement) { // there is a bug if to target passed ref\n        return props.target\n      }\n\n      const element = document.querySelector(props.target)\n\n      if (element) { return element }\n\n      warn('VaParallax target prop got wrong selector. Target is null')\n      return null\n    })\n\n    const imgHeight = computed(() => img.value?.naturalHeight || 0)\n\n    const calcDimensions = () => {\n      const offset = rootElement.value?.getBoundingClientRect() || { top: 0 }\n\n      scrollTop.value = targetElement.value?.scrollTop || 0\n      parallaxDist.value = imgHeight.value - props.height\n      elOffsetTop.value = offset.top + scrollTop.value\n      windowHeight.value = window.innerHeight\n      windowBottom.value = scrollTop.value + windowHeight.value\n    }\n\n    const translate = () => {\n      calcDimensions()\n\n      percentScrolled.value = (windowBottom.value - elOffsetTop.value) / (props.height + windowHeight.value)\n\n      parallax.value = Math.round(parallaxDist.value * percentScrolled.value) * props.speed\n\n      if (props.reversed) {\n        parallax.value = -parallax.value\n      }\n    }\n\n    const addEventListeners = () => {\n      targetElement.value?.addEventListener('scroll', translate)\n      targetElement.value?.addEventListener('resize', translate)\n    }\n\n    const removeEventListeners = () => {\n      targetElement.value?.removeEventListener('scroll', translate)\n      targetElement.value?.removeEventListener('resize', translate)\n    }\n\n    const initImage = () => {\n      if (img.value?.complete) {\n        translate()\n        addEventListeners()\n      } else {\n        img.value?.addEventListener('load', () => {\n          translate()\n          addEventListeners()\n        }, false)\n      }\n\n      isLoaded.value = true\n    }\n\n    onMounted(initImage)\n    onBeforeUnmount(removeEventListeners)\n\n    return {\n      img,\n      rootElement,\n      computedWrapperStyles,\n      computedImgStyles,\n    }\n  },\n})\n</script>\n\n<style lang=\"scss\">\n@import \"../../styles/resources\";\n@import \"variables\";\n\n.va-parallax {\n  display: var(--va-parallax-display);\n  position: relative;\n  overflow: hidden;\n  width: var(--va-parallax-width);\n  z-index: var(--va-parallax-z-index);\n  font-family: var(--va-font-family);\n\n  &__image-container {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    z-index: 1;\n    contain: var(--va-parallax-image-container-contain);\n    user-select: var(--va-parallax-image-container-user-select);\n  }\n\n  &__image {\n    position: absolute;\n    bottom: 0;\n    left: 50%;\n    min-width: 100%;\n    max-width: unset;\n    min-height: 100%;\n    display: none;\n    transform: translate(-50%, 0);\n    will-change: var(--va-parallax-image-will-change);\n    transition: var(--va-parallax-image-transition);\n    z-index: 1;\n  }\n\n  &__item-container {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    z-index: 2;\n    contain: strict;\n  }\n}\n</style>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}