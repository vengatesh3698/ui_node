{"ast":null,"code":"import { _ as _sfc_main } from \"./VaParallax.vue_vue_type_script_lang-fe8051e2.mjs\";\nimport { openBlock, createElementBlock, normalizeStyle, createElementVNode, renderSlot } from \"vue\";\nimport { _ as _export_sfc } from \"../../../plugin-vue_export-helper-cc2b3d55.mjs\";\nconst VaParallax_vue_vue_type_style_index_0_lang = \"\";\nconst _hoisted_1 = {\n  class: \"va-parallax__image-container\"\n};\nconst _hoisted_2 = [\"src\", \"alt\"];\nconst _hoisted_3 = {\n  class: \"va-parallax__item-container\"\n};\nfunction _sfc_render(_ctx, _cache, $props, $setup, $data, $options) {\n  return openBlock(), createElementBlock(\"div\", {\n    ref: \"rootElement\",\n    class: \"va-parallax\",\n    style: normalizeStyle(_ctx.computedWrapperStyles)\n  }, [createElementVNode(\"div\", _hoisted_1, [createElementVNode(\"img\", {\n    ref: \"img\",\n    class: \"va-parallax__image\",\n    src: _ctx.$props.src,\n    alt: _ctx.$props.alt,\n    style: normalizeStyle(_ctx.computedImgStyles)\n  }, null, 12, _hoisted_2)]), createElementVNode(\"div\", _hoisted_3, [renderSlot(_ctx.$slots, \"default\")])], 4);\n}\nconst _VaParallax = /* @__PURE__ */_export_sfc(_sfc_main, [[\"render\", _sfc_render]]);\nexport { _VaParallax as _ };","map":{"version":3,"names":["_hoisted_1","class","_sfc_render","_ctx","_cache","$props","$setup","$data","$options","openBlock","createElementBlock","ref","style","normalizeStyle","computedWrapperStyles","createElementVNode","src","alt","computedImgStyles","_hoisted_2","_hoisted_3"],"sources":["../../../../../src/components/va-parallax/VaParallax.vue"],"sourcesContent":["<template>\n  <div\n    ref=\"rootElement\"\n    class=\"va-parallax\"\n    :style=\"computedWrapperStyles\"\n  >\n    <div class=\"va-parallax__image-container\">\n      <img\n        ref=\"img\"\n        class=\"va-parallax__image\"\n        :src=\"$props.src\"\n        :alt=\"$props.alt\"\n        :style=\"computedImgStyles\"\n      />\n    </div>\n    <div class=\"va-parallax__item-container\">\n      <slot />\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { useComponentPresetProp } from '../../composables/useComponentPreset'\nimport { useScrollParent } from '../../composables/useScrollParent'\nimport { defineComponent, PropType, ref, computed, onMounted, onBeforeUnmount, shallowRef } from 'vue'\nimport { warn } from '../../utils/console'\n\nexport default defineComponent({\n  name: 'VaParallax',\n  props: {\n    ...useComponentPresetProp,\n    target: { type: [Object, String] as PropType<HTMLElement | string | undefined> },\n    src: { type: String, default: '', required: true },\n    alt: { type: String, default: 'parallax' },\n    height: { type: Number, default: 400 },\n    reversed: { type: Boolean, default: false },\n    speed: {\n      type: Number,\n      default: 0.5,\n      validator: (value: number) => value >= 0 && value <= 1,\n    },\n  },\n  setup (props) {\n    const rootElement = shallowRef<HTMLElement>()\n    const img = shallowRef<HTMLImageElement>()\n\n    const elOffsetTop = ref(0)\n    const parallax = ref(0)\n    const parallaxDist = ref(0)\n    const percentScrolled = ref(0)\n    const scrollTop = ref(0)\n    const windowHeight = ref(0)\n    const windowBottom = ref(0)\n    const isLoaded = ref(false)\n\n    const computedWrapperStyles = computed(() => ({ height: props.height + 'px' }))\n\n    const computedImgStyles = computed(() => ({\n      display: 'block',\n      transform: `translate(-50%, ${parallax.value}px)`,\n      opacity: isLoaded.value ? 1 : 0,\n      top: props.reversed ? 0 : 'auto',\n    }))\n\n    const { getScrollableParent } = useScrollParent()\n\n    const targetElement = computed(() => {\n      if (!props.target) {\n        return getScrollableParent(rootElement.value?.parentElement)\n      }\n\n      if (props.target instanceof HTMLElement) { // there is a bug if to target passed ref\n        return props.target\n      }\n\n      const element = document.querySelector(props.target)\n\n      if (element) { return element }\n\n      warn('VaParallax target prop got wrong selector. Target is null')\n      return null\n    })\n\n    const imgHeight = computed(() => img.value?.naturalHeight || 0)\n\n    const calcDimensions = () => {\n      const offset = rootElement.value?.getBoundingClientRect() || { top: 0 }\n\n      scrollTop.value = targetElement.value?.scrollTop || 0\n      parallaxDist.value = imgHeight.value - props.height\n      elOffsetTop.value = offset.top + scrollTop.value\n      windowHeight.value = window.innerHeight\n      windowBottom.value = scrollTop.value + windowHeight.value\n    }\n\n    const translate = () => {\n      calcDimensions()\n\n      percentScrolled.value = (windowBottom.value - elOffsetTop.value) / (props.height + windowHeight.value)\n\n      parallax.value = Math.round(parallaxDist.value * percentScrolled.value) * props.speed\n\n      if (props.reversed) {\n        parallax.value = -parallax.value\n      }\n    }\n\n    const addEventListeners = () => {\n      targetElement.value?.addEventListener('scroll', translate)\n      targetElement.value?.addEventListener('resize', translate)\n    }\n\n    const removeEventListeners = () => {\n      targetElement.value?.removeEventListener('scroll', translate)\n      targetElement.value?.removeEventListener('resize', translate)\n    }\n\n    const initImage = () => {\n      if (img.value?.complete) {\n        translate()\n        addEventListeners()\n      } else {\n        img.value?.addEventListener('load', () => {\n          translate()\n          addEventListeners()\n        }, false)\n      }\n\n      isLoaded.value = true\n    }\n\n    onMounted(initImage)\n    onBeforeUnmount(removeEventListeners)\n\n    return {\n      img,\n      rootElement,\n      computedWrapperStyles,\n      computedImgStyles,\n    }\n  },\n})\n</script>\n\n<style lang=\"scss\">\n@import \"../../styles/resources\";\n@import \"variables\";\n\n.va-parallax {\n  display: var(--va-parallax-display);\n  position: relative;\n  overflow: hidden;\n  width: var(--va-parallax-width);\n  z-index: var(--va-parallax-z-index);\n  font-family: var(--va-font-family);\n\n  &__image-container {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    z-index: 1;\n    contain: var(--va-parallax-image-container-contain);\n    user-select: var(--va-parallax-image-container-user-select);\n  }\n\n  &__image {\n    position: absolute;\n    bottom: 0;\n    left: 50%;\n    min-width: 100%;\n    max-width: unset;\n    min-height: 100%;\n    display: none;\n    transform: translate(-50%, 0);\n    will-change: var(--va-parallax-image-will-change);\n    transition: var(--va-parallax-image-transition);\n    z-index: 1;\n  }\n\n  &__item-container {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    z-index: 2;\n    contain: strict;\n  }\n}\n</style>\n"],"mappings":";;;;AAeS,MAAAA,UAAA;EAAAC,KAAA,EAAM;AAAA;;;;;SAbPC,YAAaC,IAAA,EAAAC,MAAA,EAAAC,MAAA,EAAAC,MAAA,EAAAC,KAAA,EAAAC,QAAA;EACZ,OAAAC,SAAA,IAAcC,kBAAA;IAClBC,GAAA,EAAK;IAAAV,KAAA;IAENW,KAAA,EAAAC,cAAA,CAQMV,IAAA,CARNW,qBAQM;EAAA,IANOC,kBAAA,QAAAf,UAAA,GACHe,kBAAA;IACLJ,GAAA,EAAK;IACLV,KAAA,EAAK;IACLe,GAAA,EAAKb,IAAA,CAAAE,MAAA,CAAAW,GAAA;IAAAC,GAAA,EAAAd,IAAA,CAAAE,MAAA,CAAAY,GAAA;IAAAL,KAAA,EAAAC,cAAA,CAAAV,IAAA,CAAAe,iBAAA;KAKJ,UAAAC,UAAA,KAAAJ,kBAAA,QAAAK,UAAA,G"},"metadata":{},"sourceType":"module","externalDependencies":[]}