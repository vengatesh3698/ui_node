{"ast":null,"code":"import { u as useDocument } from \"./useDocument-5c9446c6.mjs\";\nimport { u as useWindow } from \"./useWindow-549880c7.mjs\";\nconst FOCUSABLE_ELEMENTS_SELECTOR = \":where(a, button, input, textarea, select):not([disabled]), *[tabindex]\";\nlet trapInEl = null;\nconst useTrapFocus = () => {\n  const document = useDocument();\n  const window = useWindow();\n  let focusableElements = [];\n  let firstFocusableElement = null;\n  let lastFocusableElement = null;\n  let isFocusTrapped = false;\n  const focusFirstElement = () => {\n    firstFocusableElement == null ? void 0 : firstFocusableElement.focus();\n  };\n  const focusLastElement = () => {\n    lastFocusableElement == null ? void 0 : lastFocusableElement.focus();\n  };\n  const onKeydown = evt => {\n    var _a, _b;\n    const isTabPressed = evt.code === \"Tab\";\n    const isShiftPressed = evt.shiftKey;\n    if (!isTabPressed) {\n      return;\n    }\n    if (!isFocusTrapped) {\n      isFocusTrapped = true;\n      evt.preventDefault();\n      isShiftPressed ? focusLastElement() : focusFirstElement();\n      return;\n    }\n    if (((_a = document.value) == null ? void 0 : _a.activeElement) === lastFocusableElement && !isShiftPressed) {\n      evt.preventDefault();\n      focusFirstElement();\n      return;\n    }\n    if (((_b = document.value) == null ? void 0 : _b.activeElement) === firstFocusableElement && isShiftPressed) {\n      evt.preventDefault();\n      focusLastElement();\n    }\n  };\n  const trapFocusIn = el => {\n    trapInEl = el;\n    freeFocus();\n    trapFocus();\n  };\n  const trapFocus = () => {\n    var _a;\n    if (!trapInEl) {\n      return;\n    }\n    focusableElements = Array.from(trapInEl.querySelectorAll(FOCUSABLE_ELEMENTS_SELECTOR));\n    firstFocusableElement = focusableElements[0];\n    lastFocusableElement = focusableElements[focusableElements.length - 1];\n    (_a = window.value) == null ? void 0 : _a.addEventListener(\"keydown\", onKeydown);\n  };\n  const freeFocus = () => {\n    var _a;\n    focusableElements = [];\n    firstFocusableElement = null;\n    lastFocusableElement = null;\n    isFocusTrapped = false;\n    (_a = window.value) == null ? void 0 : _a.removeEventListener(\"keydown\", onKeydown);\n  };\n  return {\n    trapFocus,\n    freeFocus,\n    trapFocusIn\n  };\n};\nexport { useTrapFocus as u };","map":{"version":3,"names":["FOCUSABLE_ELEMENTS_SELECTOR","trapInEl","useTrapFocus","document","useDocument","window","useWindow","focusableElements","firstFocusableElement","lastFocusableElement","isFocusTrapped","focusFirstElement","focus","focusLastElement","onKeydown","evt","isTabPressed","code","isShiftPressed","shiftKey","preventDefault","_a","value","activeElement","_b","trapFocusIn","el","freeFocus","trapFocus","Array","from","querySelectorAll","length","addEventListener","removeEventListener"],"sources":["../../../../src/composables/useTrapFocus.ts"],"sourcesContent":["import { useDocument } from './useDocument'\nimport { useWindow } from './useWindow'\n\nconst TAB_KEYCODE = 9\nconst FOCUSABLE_ELEMENTS_SELECTOR = ':where(a, button, input, textarea, select):not([disabled]), *[tabindex]'\nlet trapInEl: HTMLElement | null = null\n\nexport const useTrapFocus = () => {\n  const document = useDocument()\n  const window = useWindow()\n\n  let focusableElements: HTMLElement[] = []\n  let firstFocusableElement: HTMLElement | null = null\n  let lastFocusableElement: HTMLElement | null = null\n  let isFocusTrapped = false\n\n  const focusFirstElement = () => {\n    firstFocusableElement?.focus()\n  }\n  const focusLastElement = () => {\n    lastFocusableElement?.focus()\n  }\n\n  const onKeydown = (evt: KeyboardEvent) => {\n    const isTabPressed = evt.code === 'Tab'\n    const isShiftPressed = evt.shiftKey\n\n    if (!isTabPressed) {\n      return\n    }\n\n    if (!isFocusTrapped) {\n      isFocusTrapped = true\n\n      evt.preventDefault()\n      isShiftPressed ? focusLastElement() : focusFirstElement()\n\n      return\n    }\n\n    if (document.value?.activeElement === lastFocusableElement && !isShiftPressed) {\n      evt.preventDefault()\n      focusFirstElement()\n      return\n    }\n\n    if (document.value?.activeElement === firstFocusableElement && isShiftPressed) {\n      evt.preventDefault()\n      focusLastElement()\n    }\n  }\n\n  const trapFocusIn = (el: HTMLElement) => {\n    trapInEl = el\n\n    freeFocus()\n    trapFocus()\n  }\n\n  const trapFocus = () => {\n    if (!trapInEl) {\n      return\n    }\n\n    focusableElements = Array.from(trapInEl.querySelectorAll(FOCUSABLE_ELEMENTS_SELECTOR))\n    firstFocusableElement = focusableElements[0]\n    lastFocusableElement = focusableElements[focusableElements.length - 1]\n\n    window.value?.addEventListener('keydown', onKeydown)\n  }\n  const freeFocus = () => {\n    focusableElements = []\n    firstFocusableElement = null\n    lastFocusableElement = null\n    isFocusTrapped = false\n\n    window.value?.removeEventListener('keydown', onKeydown)\n  }\n\n  return {\n    trapFocus,\n    freeFocus,\n    trapFocusIn,\n  }\n}\n"],"mappings":";;AAIA,MAAMA,2BAAA,GAA8B;AACpC,IAAIC,QAAA,GAA+B;AAE5B,MAAMC,YAAA,GAAeA,CAAA,KAAM;EAChC,MAAMC,QAAA,GAAWC,WAAA;EACjB,MAAMC,MAAA,GAASC,SAAA;EAEf,IAAIC,iBAAA,GAAmC;EACvC,IAAIC,qBAAA,GAA4C;EAChD,IAAIC,oBAAA,GAA2C;EAC/C,IAAIC,cAAA,GAAiB;EAErB,MAAMC,iBAAA,GAAoBA,CAAA,KAAM;IAC9BH,qBAAA,oBAAAA,qBAAA,CAAuBI,KAAA;EAAM;EAE/B,MAAMC,gBAAA,GAAmBA,CAAA,KAAM;IAC7BJ,oBAAA,oBAAAA,oBAAA,CAAsBG,KAAA;EAAM;EAGxB,MAAAE,SAAA,GAAaC,GAAA,IAAuB;;IAClC,MAAAC,YAAA,GAAeD,GAAA,CAAIE,IAAA,KAAS;IAClC,MAAMC,cAAA,GAAiBH,GAAA,CAAII,QAAA;IAE3B,IAAI,CAACH,YAAA,EAAc;MACjB;IACF;IAEA,IAAI,CAACN,cAAA,EAAgB;MACFA,cAAA;MAEjBK,GAAA,CAAIK,cAAA,CAAe;MACFF,cAAA,GAAAL,gBAAA,KAAqBF,iBAAA;MAEtC;IACF;IAEA,MAAIU,EAAA,GAAAlB,QAAA,CAASmB,KAAA,KAAT,gBAAAD,EAAA,CAAgBE,aAAA,MAAkBd,oBAAA,IAAwB,CAACS,cAAA,EAAgB;MAC7EH,GAAA,CAAIK,cAAA,CAAe;MACDT,iBAAA;MAClB;IACF;IAEA,MAAIa,EAAA,GAAArB,QAAA,CAASmB,KAAA,KAAT,gBAAAE,EAAA,CAAgBD,aAAA,MAAkBf,qBAAA,IAAyBU,cAAA,EAAgB;MAC7EH,GAAA,CAAIK,cAAA,CAAe;MACFP,gBAAA;IACnB;EAAA;EAGI,MAAAY,WAAA,GAAeC,EAAA,IAAoB;IAC5BzB,QAAA,GAAAyB,EAAA;IAEDC,SAAA;IACAC,SAAA;EAAA;EAGZ,MAAMA,SAAA,GAAYA,CAAA,KAAM;;IACtB,IAAI,CAAC3B,QAAA,EAAU;MACb;IACF;IAEAM,iBAAA,GAAoBsB,KAAA,CAAMC,IAAA,CAAK7B,QAAA,CAAS8B,gBAAA,CAAiB/B,2BAA2B,CAAC;IACrFQ,qBAAA,GAAwBD,iBAAA,CAAkB,CAAC;IACpBE,oBAAA,GAAAF,iBAAA,CAAkBA,iBAAA,CAAkByB,MAAA,GAAS,CAAC;IAE9D,CAAAX,EAAA,GAAAhB,MAAA,CAAAiB,KAAA,qBAAAD,EAAA,CAAOY,gBAAA,CAAiB,WAAWnB,SAAA;EAAS;EAErD,MAAMa,SAAA,GAAYA,CAAA,KAAM;;IACtBpB,iBAAA,GAAoB;IACIC,qBAAA;IACDC,oBAAA;IACNC,cAAA;IAEV,CAAAW,EAAA,GAAAhB,MAAA,CAAAiB,KAAA,qBAAAD,EAAA,CAAOa,mBAAA,CAAoB,WAAWpB,SAAA;EAAS;EAGjD;IACLc,SAAA;IACAD,SAAA;IACAF;EAAA;AAEJ"},"metadata":{},"sourceType":"module","externalDependencies":[]}