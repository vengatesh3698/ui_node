{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\nimport { ref, computed, getCurrentInstance } from \"vue\";\nimport { b as clamp } from \"../../../../vendor-fff696df.mjs\";\nimport { R as RatingValue } from \"../types-7212ca12.mjs\";\nimport { a as useStatefulProps, b as useStateful } from \"../../../composables/useStateful-50e4a6b9.mjs\";\nimport { u as useHover } from \"../../../composables/useHover-5978b32d.mjs\";\nconst getContext = () => {\n  const instance = getCurrentInstance();\n  if (!instance) {\n    throw new Error(\"useRating hooks must be used on top of setup function\");\n  }\n  return {\n    props: instance.props,\n    emit: instance.emit\n  };\n};\nconst useRatingProps = {\n  ...useStatefulProps,\n  modelValue: {\n    type: Number,\n    default: 0\n  },\n  clearable: {\n    type: Boolean,\n    default: false\n  },\n  hover: {\n    type: Boolean,\n    default: false\n  }\n};\nconst useRating = props => {\n  const {\n    emit\n  } = getContext();\n  const {\n    isHovered,\n    onMouseEnter,\n    onMouseLeave\n  } = useHover();\n  const {\n    valueComputed: modelValue\n  } = useStateful(props, emit);\n  const hoveredValue = ref(0);\n  const visibleValue = computed(() => !props.disabled && !props.readonly && props.hover && isHovered.value ? hoveredValue.value : modelValue.value);\n  const onItemValueUpdate = (itemIndex, newValue) => {\n    const newModelValue = itemIndex + newValue;\n    if (props.clearable) {\n      if (modelValue.value === newModelValue) {\n        modelValue.value = 0;\n        return;\n      }\n    }\n    modelValue.value = newModelValue;\n  };\n  const onItemHoveredValueUpdate = (itemIndex, newValue) => {\n    if (!props.hover) {\n      return;\n    }\n    hoveredValue.value = itemIndex + newValue;\n  };\n  const getItemValue = itemIndex => {\n    const itemValue = visibleValue.value - itemIndex;\n    return clamp(itemValue, RatingValue.EMPTY, RatingValue.FULL);\n  };\n  return {\n    visibleValue,\n    modelValue,\n    hoveredValue,\n    isHovered,\n    onMouseEnter,\n    onMouseLeave,\n    onItemValueUpdate,\n    onItemHoveredValueUpdate,\n    getItemValue\n  };\n};\nexport { useRating as a, useRatingProps as u };","map":{"version":3,"names":["getContext","instance","getCurrentInstance","Error","props","emit","useRatingProps","useStatefulProps","modelValue","type","Number","default","clearable","Boolean","hover","useRating","isHovered","onMouseEnter","onMouseLeave","useHover","valueComputed","useStateful","hoveredValue","ref","visibleValue","computed","disabled","readonly","value","onItemValueUpdate","itemIndex","newValue","newModelValue","onItemHoveredValueUpdate","getItemValue","itemValue","clamp","RatingValue","EMPTY","FULL"],"sources":["../../../../../../src/components/va-rating/hooks/useRating.ts"],"sourcesContent":["import { ref, getCurrentInstance, computed, ExtractPropTypes } from 'vue'\nimport clamp from 'lodash/clamp.js'\n\nimport { useHover, useStateful, useStatefulProps, useFormFieldProps } from '../../../composables'\n\nimport { RatingValue } from '../types'\n\nconst getContext = <P extends Record<string, any> = Record<string, any>, E extends string = string>() => {\n  const instance = getCurrentInstance()\n  if (!instance) { throw new Error('useRating hooks must be used on top of setup function') }\n  return {\n    props: instance.props,\n    emit: instance.emit,\n  } as {\n    props: P,\n    emit: (event: E, ...args: any[]) => void\n  }\n}\n\nexport const useRatingProps = {\n  ...useStatefulProps,\n  modelValue: { type: Number, default: 0 },\n  clearable: { type: Boolean, default: false },\n  hover: { type: Boolean, default: false },\n}\n\nexport const useRating = (props: ExtractPropTypes<typeof useRatingProps> & ExtractPropTypes<typeof useFormFieldProps>) => {\n  const { emit } = getContext()\n  const { isHovered, onMouseEnter, onMouseLeave } = useHover()\n  const { valueComputed: modelValue } = useStateful(props, emit)\n\n  const hoveredValue = ref(0)\n  const visibleValue = computed(() => !props.disabled && !props.readonly && props.hover && isHovered.value ? hoveredValue.value : modelValue.value)\n\n  const onItemValueUpdate = (itemIndex: number, newValue: number) => {\n    const newModelValue = itemIndex + newValue\n    if (props.clearable) {\n      if (modelValue.value === newModelValue) {\n        modelValue.value = 0\n        return\n      }\n    }\n    modelValue.value = newModelValue\n  }\n\n  const onItemHoveredValueUpdate = (itemIndex: number, newValue: number) => {\n    if (!props.hover) { return }\n    hoveredValue.value = itemIndex + newValue\n  }\n\n  const getItemValue = (itemIndex: number) => {\n    const itemValue = visibleValue.value - itemIndex\n    return clamp(itemValue, RatingValue.EMPTY, RatingValue.FULL)\n  }\n\n  return {\n    visibleValue,\n    modelValue,\n    hoveredValue,\n    isHovered,\n    onMouseEnter,\n    onMouseLeave,\n    onItemValueUpdate,\n    onItemHoveredValueUpdate,\n    getItemValue,\n  }\n}\n"],"mappings":";;;;;;AAOA,MAAMA,UAAA,GAAaA,CAAA,KAAsF;EACvG,MAAMC,QAAA,GAAWC,kBAAA;EACjB,IAAI,CAACD,QAAA,EAAU;IAAQ,UAAIE,KAAA,CAAM,uDAAuD;EAAE;EACnF;IACLC,KAAA,EAAOH,QAAA,CAASG,KAAA;IAChBC,IAAA,EAAMJ,QAAA,CAASI;EAAA;AAKnB;AAEO,MAAMC,cAAA,GAAiB;EAC5B,GAAGC,gBAAA;EACHC,UAAA,EAAY;IAAEC,IAAA,EAAMC,MAAA;IAAQC,OAAA,EAAS;EAAE;EACvCC,SAAA,EAAW;IAAEH,IAAA,EAAMI,OAAA;IAASF,OAAA,EAAS;EAAM;EAC3CG,KAAA,EAAO;IAAEL,IAAA,EAAMI,OAAA;IAASF,OAAA,EAAS;EAAM;AACzC;AAEa,MAAAI,SAAA,GAAaX,KAAA,IAAgG;EAClH;IAAEC;EAAA,IAASL,UAAA;EACjB,MAAM;IAAEgB,SAAA;IAAWC,YAAA;IAAcC;EAAA,IAAiBC,QAAA,CAAS;EAC3D,MAAM;IAAEC,aAAA,EAAeZ;EAAA,IAAea,WAAA,CAAYjB,KAAA,EAAOC,IAAI;EAEvD,MAAAiB,YAAA,GAAeC,GAAA,CAAI,CAAC;EAC1B,MAAMC,YAAA,GAAeC,QAAA,CAAS,MAAM,CAACrB,KAAA,CAAMsB,QAAA,IAAY,CAACtB,KAAA,CAAMuB,QAAA,IAAYvB,KAAA,CAAMU,KAAA,IAASE,SAAA,CAAUY,KAAA,GAAQN,YAAA,CAAaM,KAAA,GAAQpB,UAAA,CAAWoB,KAAK;EAE1I,MAAAC,iBAAA,GAAoBA,CAACC,SAAA,EAAmBC,QAAA,KAAqB;IACjE,MAAMC,aAAA,GAAgBF,SAAA,GAAYC,QAAA;IAClC,IAAI3B,KAAA,CAAMQ,SAAA,EAAW;MACf,IAAAJ,UAAA,CAAWoB,KAAA,KAAUI,aAAA,EAAe;QACtCxB,UAAA,CAAWoB,KAAA,GAAQ;QACnB;MACF;IACF;IACApB,UAAA,CAAWoB,KAAA,GAAQI,aAAA;EAAA;EAGf,MAAAC,wBAAA,GAA2BA,CAACH,SAAA,EAAmBC,QAAA,KAAqB;IACpE,KAAC3B,KAAA,CAAMU,KAAA,EAAO;MAAE;IAAO;IAC3BQ,YAAA,CAAaM,KAAA,GAAQE,SAAA,GAAYC,QAAA;EAAA;EAG7B,MAAAG,YAAA,GAAgBJ,SAAA,IAAsB;IACpC,MAAAK,SAAA,GAAYX,YAAA,CAAaI,KAAA,GAAQE,SAAA;IACvC,OAAOM,KAAA,CAAMD,SAAA,EAAWE,WAAA,CAAYC,KAAA,EAAOD,WAAA,CAAYE,IAAI;EAAA;EAGtD;IACLf,YAAA;IACAhB,UAAA;IACAc,YAAA;IACAN,SAAA;IACAC,YAAA;IACAC,YAAA;IACAW,iBAAA;IACAI,wBAAA;IACAC;EAAA;AAEJ"},"metadata":{},"sourceType":"module","externalDependencies":[]}